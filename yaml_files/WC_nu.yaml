#############################################################################
## GAMBIT configuration for a diver scan of flavour physics in the GTHDM
##
## Uses likelihood constraints from flavour physics observables only,
## without nuisance parameters.
#############################################################################


Parameters:

  WC_nu:
    CL:
      prior: flat
      range: [-1.,1.]
    CR:
      prior: flat
      range: [-1.,1.]

Priors:

  # All priors are simple, so specified in Parameters section


Printer:

  printer: cout
  options:
    output_file: "WC_nu.hdf5"
    group: "/WC_nu"
    delete_file_on_restart: true

Scanner:

  use_scanner: random

  scanners:

    multinest:
      plugin: multinest
      like:  LogLike
      nlive: 400
      tol: 0.1

    de:
      plugin: diver
      like: LogLike
      NP: 400
      convthresh: 1e-3

    square_grid:
      plugin: square_grid
      like: LogLike
      grid_pts: 20

    random:
      plugin: random
      like: LogLike
      point_number: 2

ObsLikes:

    #########################
    # Precision likelihoods #
    #########################

    # Calculates the electroweak precision parameters, S, T, U, V, W, X
    # & fits to meausured values. S, T, U involve a correlation matrix.
    # Includes low-energy notation described in arxiv::9407203.
    # Likelihood type: Half-Gaussian

  - purpose:    LogLike
    capability: oblique_parameters_LogLikelihood
    function: get_oblique_parameters_LogLikelihood

    # muon g-2 likelihood
#  - capability: lnL_gm2
#    function: lnL_gm2
#    purpose: LogLike


    ###############################
    # Flavour physics likelihoods #
    ###############################

    # ------------------------- #
    # B -> Xs gamma likelihoods #
    # ------------------------- #

  - purpose:    LogLike
    capability: b2sgamma_LogLikelihood

  - purpose:    LogLike
    capability: B2Kstargamma_LogLikelihood


    # ---------------------- #
    # B -> mu mu likelihoods #
    # ---------------------- #

  - purpose:    LogLike
    capability: B2mumu_LogLikelihood_Atlas
    sub_capabilities: [BRuntag_Bsmumu, BR_Bdmumu]

  - purpose:    LogLike
    capability: B2mumu_LogLikelihood_CMS
    sub_capabilities: [BRuntag_Bsmumu, BR_Bdmumu]

  - purpose:    LogLike
    capability: B2mumu_LogLikelihood_LHCb
    sub_capabilities: [BRuntag_Bsmumu, BR_Bdmumu]


    # ------------------------ #
    # B -> K mu mu likelihoods #
    # ------------------------ #

  - purpose:    LogLike
    capability: Bd2KmumuBr_LogLikelihood_LHCb

  - purpose:    LogLike
    capability: Bd2KmumuBr_LogLikelihood_Belle

  - purpose:    LogLike
    capability: B2KmumuBr_LogLikelihood_LHCb

  - purpose: LogLike
    capability: B2KmumuBr_LogLikelihood_CMS

  - purpose: LogLike
    capability: B2KmumuBr_LogLikelihood_Belle


    # ---------------------- #
    # B -> K e e likelihoods #
    # ---------------------- #

#  - purpose:    LogLike
#    capability: B2KeeBr_LogLikelihood_Belle

#  - purpose:    LogLike
#    capability: Bd2KeeBr_LogLikelihood_Belle


    # ------------------------- #
    # B -> K* mu mu likelihoods #
    # ------------------------- #

  - purpose:    LogLike
    capability: B2KstarmumuAng_LogLikelihood_Atlas
    sub_capabilities: [FL, S3, S4, S5, S7, S8]

  - purpose:    LogLike
    capability: B2KstarmumuAng_LogLikelihood_CMS
    sub_capabilities: [P1, P5prime]

  - purpose:    LogLike
    capability: B2KstarmumuAng_LogLikelihood_Belle
    sub_capabilities: [P4prime, P5prime]

  - purpose:    LogLike
    capability: B2KstarmumuAng_LogLikelihood_LHCb_2020
    sub_capabilities: [FL, AFB, S3, S4, S5, S7, S8, S9]

  - purpose:    LogLike
    capability: Bu2KstarmumuAng_LogLikelihood_LHCb_2020
    sub_capabilities: [FL, AFB, S3, S4, S5, S7, S8, S9]

  - purpose:    LogLike
    capability: B2KstarmumuBr_LogLikelihood_LHCb

  - purpose:    LogLike
    capability: Bs2phimumuBr_LogLikelihood


    # ---------------------- #
    # B -> K e e likelihoods #
    # ---------------------- #

#  - purpose:    LogLike
#    capability: B2KstareeAng_Lowq2_LogLikelihood_LHCb_2020
#    sub_capabilities: [FLee, AT_Re, AT_2, AT_Im]


    # ----------------------- #
    # B -> K* e e likelihoods #
    # ----------------------- #

#  - purpose:    LogLike
#    capability: B2KstareeAng_Lowq2_LogLikelihood_LHCb_2020
#    sub_capabilities: [FLee, AT_Re, AT_2, AT_Im]


    # ---------------------- #
    # RK and RK* likelihoods #
    # ---------------------- #

  - purpose: LogLike
    capability: RKRKstar_LogLikelihood_LHCb
    sub_capabilities: [RK, RKstar]

  - purpose: LogLike
    capability: RK_LogLikelihood_CMS

  - purpose: LogLike
    capability: RK_LogLikelihood_Belle


    # ------------------------ #
    # B -> K nu nu likelihoods #
    # ------------------------ #

  - purpose: LogLike
    capability: BKnunu_LogLikelihood_Belle_sl

  - purpose: LogLike
    capability: BKnunu_LogLikelihood_Belle_had

  - purpose: LogLike
    capability: BuKnunu_LogLikelihood_Belle_sl

  - purpose: LogLike
    capability: BuKnunu_LogLikelihood_Belle_had

  - purpose: LogLike
    capability: BuKnunu_LogLikelihood_BelleII

  - purpose: LogLike
    capability: BKnunu_LogLikelihood_BaBar

  - purpose: LogLike
    capability: BuKnunu_LogLikelihood_BaBar

#  - purpose: LogLike
#    capability: BKstarnunu_LogLikelihood_Belle_sl

#  - purpose: LogLike
#    capability: BKstarnunu_LogLikelihood_Belle_had

#  - purpose: LogLike
#    capability: BuKstarnunu_LogLikelihood_Belle_sl

#  - purpose: LogLike
#    capability: BuKstarnunu_LogLikelihood_Belle_had

#  - purpose: LogLike
#    capability: BKstarnunu_LogLikelihood_BaBar

#  - purpose: LogLike
#    capability: BuKstarnunu_LogLikelihood_BaBar


    # ----------------------------- #
    # Semileptonic FCCC likelihoods #
    # ----------------------------- #

    # NOTE: this likelihood could contain other semileptonic decays, but for now only RD and RD* are enabled
  - capability: SL_LogLikelihood
    sub_capabilities: [RD,RDstar]
    function: SL_likelihood
    purpose: LogLike

    # FLDstar likelihood
#  - capability: FLDstar_LogLikelihood
#    function: FLDstar_likelihood
#    purpose: LogLike

    # B->Dstar,l,nu likelihood [Normalized differential decay width]
#  - capability: dBRBDstartaunu_LogLikelihood
#    function: dBRBDstartaunu_likelihood
#    purpose: LogLike

    # B->D,l,nu likelihood [Normalized differential decay width]
#  - capability: dBRBDtaunu_LogLikelihood
#    function: dBRBDtaunu_likelihood
#    purpose: LogLike


    # --------------------------------- #
    # Lifetime and Delta MB likelihoods #
    # --------------------------------- #

    #Bc->tanu lifetime likelihood
  - capability: Bc_lifetime_LogLikelihood
    function: Bc_lifetime_likelihood
    purpose: LogLike

  - capability: deltaMB_LogLikelihood
    function: deltaMB_likelihood
    purpose: LogLike


    # ------------------------------------ #
    # Lepton flavour violating likelihoods #
    # ------------------------------------ #

#  - capability: l2lll_LogLikelihood
#    function: l2lll_likelihood
#    purpose: LogLike

  - capability: l2lgamma_LogLikelihood
    function: l2lgamma_likelihood
    purpose: LogLike

  - capability: h2ltau_LogLikelihood
    function: h2ltau_LogLikelihood
    purpose: LogLike

    # --------------------------------------- #
    # Flavour violating top decay likelihoods #
    # --------------------------------------- #

  - purpose: LogLike
    capability: t2bbc_LogLikelihood

  - purpose: LogLike
    capability: t2ch_LogLikelihood


    ###############
    # Observables #
    ###############

    # ------------------- #
    # Flavour predictions #
    # ------------------- #

  - purpose: Observable
    capability: prediction_RKRKstar_LHCb
    sub_capabilities: [RK, RKstar]

  - purpose: Observable
    capability: prediction_B2mumu
    function: SuperIso_prediction_B2mumu
    sub_capabilities: [BRuntag_Bsmumu, BR_Bdmumu]

  - purpose: Observable
    capability: B2Knunu

  - purpose: Observable
    capability: Bu2Knunu

    # --------------------- #
    # Precision predictions #
    # --------------------- #

  - capability: muon_gm2
    function: THDM_mumugamma
    purpose: Observable

Rules:

  # Use SuperIso instead of FeynHiggs for b->sgamma
  - capability: prediction_b2sgamma
    function: SuperIso_prediction_b2sgamma

  # Use SuperIso instead of FeynHiggs for B_s->mumu
  - capability: prediction_B2mumu
    function: SuperIso_prediction_B2mumu

  - capability: couplingtable_THDM
    function: get_coupling_table_using_physical_basis

  - capability: decay_rates
    function: all_decays


Logger:

  redirection:
    #[Debug]   : "debug.log"
    [Default] : "default.log"
   # [FlavBit] : "FlavBit.log"


KeyValues:

  dependency_resolution:
    prefer_model_specific_functions: true

  likelihood:
    model_invalid_for_lnlike_below: -5e6
    model_invalid_for_lnlike_below_alt: -1e6

  default_output_path: "runs/WC_nu"

  debug: true

