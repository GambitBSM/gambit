#########################################################################
## GAMBIT configuration for running a diver scan of the THDM
## THDM_TEST
##
## Includes all compatible likelihoods:
## Theoretical, experimental & flavor
##
## Requires backends:
## THDMC, SuperISO, HiggsBounds, HiggsSignals
##########################################################################

Parameters:
  StandardModel_SLHA2:
    CKM_A: 0.814
    CKM_etabar: 0.353
    CKM_lambda: 0.22537
    CKM_rhobar: 0.117
    GF: 1.16638e-05
    alpha1: 0
    alpha2: 0
    alphaS: 0.1181
    alphainv: 127.95
    delta13: 0
    mBmB: 4.18
    mCmC: 1.28
    mD: 0.0047
    mE: 0.000510999
    mMu: 0.105658
    mNu1: 0
    mNu2: 0
    mNu3: 0
    mS: 0.096
    mT: 173.34
    mTau: 1.77686
    mU: 0.0022
    mZ: 91.1876
    theta12: 0.58376
    theta13: 0.15495
    theta23: 0.76958
  THDM_physical:
      sba: 0.9999
      yl2_re_32: -0.293452
      yu2_re_33: 0.99946
      yu2_re_32: -1.1456
      mC2: 4840000.0
      tanb: 1
      yl2_re_22: -0.301196
      lambda6: 0.0
      lambda7: 0.0
      m12_2: 2250000.0
      mA2: 4840000.0
      mH2: 4840000.0
      mh2: 15650.01
      yd2_im_11: 0.0
      yd2_im_12: 0.0
      yd2_im_13: 0.0
      yd2_im_21: 0.0
      yd2_im_22: 0.0
      yd2_im_23: 0.0
      yd2_im_31: 0.0
      yd2_im_32: 0.0
      yd2_im_33: 0.0
      yd2_re_11: 0.0
      yd2_re_12: 0.0
      yd2_re_13: 0.0
      yd2_re_21: 0.0
      yd2_re_22: 0.0
      yd2_re_23: 0.0
      yd2_re_31: 0.0
      yd2_re_32: 0.0
      yd2_re_33: 0.0234969
      yl2_im_11: 0.0
      yl2_im_12: 0.0
      yl2_im_13: 0.0
      yl2_im_21: 0.0
      yl2_im_22: 0.0
      yl2_im_23: 0.0
      yl2_im_31: 0.0
      yl2_im_32: 0.0
      yl2_im_33: 0.0
      yl2_re_11: 0.0
      yl2_re_12: 0.0
      yl2_re_13: 0.0
      yl2_re_21: 0.0
      yl2_re_23: -0.293452
      yl2_re_31: 0.0
      yl2_re_33: -1.0
      yu2_im_11: 0.0
      yu2_im_12: 0.0
      yu2_im_13: 0.0
      yu2_im_21: 0.0
      yu2_im_22: 0.0
      yu2_im_23: 0.0
      yu2_im_31: 0.0
      yu2_im_32: 0.0
      yu2_im_33: 0.0
      yu2_re_11: 0.0
      yu2_re_12: 0.0
      yu2_re_13: 0.0
      yu2_re_21: 0.0
      yu2_re_22: 0.0
      yu2_re_23: -1.1456
      yu2_re_31: 0.0
# Printer setup
##############################

Printer:

  # Select printer to use via string tag
  printer: cout

  options:
    # name of output file
    output_file: "THDM_TEST.hdf5"
    group: "/THDM_TEST"
    delete_file_on_restart: true


##############################
# Scanner setup
##############################

Scanner:

  use_scanner: random

  scanners:

    de:
      plugin: diver
      like: LogLike
      NP: 3000
      convthresh: 1e-3
      verbosity: 1

    random:
      plugin: random
      like: LogLike
      point_number: 1

      # No options to set, but still need the nodes at the moment...
      aux_printer_txt_options:
      aux_printer_stats_options:
      aux_printer_live_options:

ObsLikes:

    ###########################
    # Likelihoods
    ###########################

    # B->s,gamma likelihood (using HEPlike)
    - capability: b2sgamma_LogLikelihood
      function: HEPLike_b2sgamma_LogLikelihood
      purpose: LogLike

    #delta0 likelihood 
    - capability: delta0_LL
      function: delta0_ll
      purpose: LogLike

    #delta0 obs
    - capability: delta0
      function: SI_delta0
      purpose: Observable

    # B->tau,nu likelihood (using HEPlike)
   # - capability: B2taunu_LogLikelihood
    #  function: HEPLike_B2taunu_LogLikelihood
    #  purpose: LogLike

   # B->mu,mu LHCb likelihood (using HEPlike)
    - capability: B2mumu_LogLikelihood_LHCb
      function: HEPLike_B2mumu_LogLikelihood_LHCb
      purpose: LogLike

    # Semi-Leptonic likelihood collection 8 obs (Ds,D->munu,Ds->taunu, RD(*) and included Rmu=BR(K->munu)/BR(pi->munu))
    - capability: SL_LL
      function: SL_likelihood
      purpose: LogLike
    
    #g-2 likelihood 
  #  - capability: lnL_gm2
   #   function: lnL_gm2
    #  purpose: LogLike

   #LU observable (gmu/g2)^2=BR(tau->mununu)/BR(tau->enunu)
    - capability: gmu_ge_lnL
      function: gmu_ge_likelihood
      purpose: LogLike
    
    #Need to call tau->mu gamma likelihood
    #l->lll likelihood goes here, removed temporarily

    # FLDstar likelihood 
    - capability: FLDstar_lnL
      function: FLDstar_likelihood
      purpose: LogLike

    # Bc->tanu lifetime likelihood 
    - capability: Bc_lifetime_lnL
      function: Bc_lifetime_likelihood
      purpose: LogLike

    # # B->Dstar,l,nu likelihood [Normalized differential decay width]
    - capability: BDstartaunu_LL
      function: BDstartaunu_likelihood
      purpose: LogLike

    # # B->D,l,nu likelihood [Normalized differential decay width]
    - capability: BDtaunu_LL
      function: BDtaunu_likelihood
      purpose: LogLike

    # B->Kstarll angular for 6 bins, 48 obs in total:FL,AFB,S3,S4,S5,S7,S8,S9
    - capability: b2sll_LL
      function: b2sll_likelihood
      purpose: LogLike

    # # B->Kstarll branching for 6 bins 
    - capability: b2sll_BR_LL
      function: b2sll_BR_likelihood
      purpose: LogLike

    # LUV likelihood collection (RKstar_0045_11 and RKstar_11_60) 
    - purpose: LogLike
      capability: LUV_LL

   # B->Kstar,l,l likelihood [isospin asymmetry lowq2]
    - capability: b2sll_AI_LL
      function: BKstarmumu_AI_ll
      purpose: LogLike

    # # B->Kstar,l,l likelihood [isospin asymmetry zero-crossing]
    - capability: b2sll_AI_zero_LL
      function: BKstarmumu_AI_zero_ll
      purpose: LogLike

    #################
    # Observables
    #################
    # Print spectrum as a map
    - capability: THDM_spectrum
      purpose: Observable
      type: map_str_dbl

Rules:

    ##############################
    # Likelihood/Observable Rules
    ##############################

    - capability: SuperIso_modelinfo
      function: SI_fill

    - capability: delta0
      function: SI_delta0

    - capability: B2taunu_LogLikelihood
      function: HEPLike_B2taunu_LogLikelihood

    #- capability: prediction_B2taunu
     # function: SuperIso_prediction_B2taunu

    - capability: b2sll_M
      function: b2sll_measurements

    - capability: BDlnu_dBR_M
      function: BDlnu_dBR_measurement

    # Choose to use superiso for RK calcs
    - capability: RK
      function: SI_RK

    - capability: RKstar_0045_11
      function: SI_RKstar_0045_11

    - capability: RKstar_11_60
      function: SI_RKstar_11_60

    - capability: lnL_gm2
      function: lnL_gm2
      dependencies:
        - capability: muon_gm2
          function: THDM_mumugamma
          module: PrecisionBit
    # ----------------------

#########################
# Logging setup
#########################

Logger:

  redirection:
    [Debug] :  "Debug.log"
    [Default] :  "Default.log"
    #[DecayBit] :  "DecayBit.log"
    #[DarkBit] :  "DarkBit.log"
   # [PrecisionBit] :  "PrecisionBit.log"
    #[ColliderBit] :  "ColliderBit.log"
    [SpecBit] :  "SpecBit.log"
    [Dependency Resolver] :  "DepResolver.log"
    [Scanner]:  "Scanner.log"

##########################
# Name/Value Section
##########################

KeyValues:

  likelihood:
    model_invalid_for_lnlike_below: -1e6
    model_invalid_for_lnlike_below_alt: -5e5
    debug: false

  dependency_resolution:
    prefer_model_specific_functions: true
    use_old_routines: false

  #By default, errors are fatal and warnings non-fatal
  exceptions:
    dependency_resolver_error: fatal
    dependency_resolver_warning: non-fatal
    core_warning: fatal

  default_output_path: "runs/THDM_TEST/"
  debug: true
