##################################################################################################################
##
## YAML file for an 11-dimensional scan of 3-flavour DM EFT model with DAMA + direct detection likelihoods.
##
##################################################################################################################

Parameters:

  # SM parameters.
  StandardModel_SLHA2: !import include/StandardModel_SLHA2_defaults.yaml

  StandardModel_Higgs:
     mH: 125.10 # PDG 2020 value

  # Direct detection
  nuclear_params_ChPT:
    B0md: 0.00133
    B0ms: 0.268
    B0mu: 0.0061
    BT10dp: 0.24
    BT10s: 0.0
    BT10up: 3.0
    DeltauDeltad: 0.521 # equals Deltadp + Deltaup in BF file
    Deltas: -0.031
    gA: 1.2723
    gTd: -0.204
    gTs: 0.00032
    gTu: 0.794
    mG: 0.848
    mun: -1.913 # an = mun
    mup: 2.793 # ap = mup - 1
    mus: -0.064  # equals F2sp in BF file
    sigmadn: 0.036
    sigmadp: 0.032
    sigmas: 0.0413
    sigmaun: 0.015
    sigmaup: 0.017
    rs2: -0.115 # NOT in BF file

  DMEFT_3flavour:
    # DM mass
    mchi: 
      range: [2, 200]
      prior_type: log
    # EM interactions
    C51: 
      prior_type: log
      range: [1e-06, 1e0]
    C52: 
      prior_type: log
      range: [1e-6, 1e0]
    # Dim 6 -- qq chi chi bilinears
    # vector vector
    C61: 
      prior_type: log
      range: [1e-6, 1e-2]
    theta61: 
      prior_type: flat
      range: [0,6.2831853]
    # axial-vector vector
    C62:
      prior_type: log
      range: [1e-06, 1e1]
    theta62:
      prior_type: flat
      range: [0, 6.2831853]
    # vector axial-vector
    C63:
      prior_type: log
      range: [1e-06, 1e1]
    theta63:
      prior_type: flat
      range: [0, 6.2831853]
    # axial-vector axial-vector
    C64:
      prior_type: log
      range: [1e-6,1e1]
    theta64:
      prior_type: flat
      range: [0,6.2831853]

  # NFW with standard & central values for prelims
  Halo_gNFW_rho0:
    rho0: 0.4
    v0: 235.0
    vesc: 550.0
    vrot: 235.0
    rs: 20.0
    r_sun: 8.5
    alpha: 1
    beta: 3
    gamma: 1


Priors:

  # All the priors are simple for this scan, so they are specified directly in the Parameters section.

Printer:

  printer: cout

  options:
    output_file: "DMEFT_3flavour_DAMA.hdf5"
    group: "/DMEFT_3flavour_DAMA"
    buffer_length: 10
    delete_file_on_restart: true


Scanner:

  use_scanner: random

  scanners:

    square_grid:
      plugin: square_grid
      like: LogLike
      grid_pts: 1
    
    random: 
      plugin: random
      like: LogLike
      point_number: 100

    diver: 
      plugin: diver
      like: LogLike
      NP: 12000
      convthresh: 1E-3
      lambdajDE: false

ObsLikes:

  # Direct detection likelihoods
#  - capability: DAMA_LogLikelihood_mod
#    purpose:    Observable

  - capability: nflavours
    porpose:    Observable

  - capability: LUX_2016_LogLikelihood
    purpose:    LogLike

#  - capability: XENON1T_2018_LogLikelihood
#    purpose:    LogLike

#  - capability: PandaX_2016_LogLikelihood
#    purpose:    LogLike

#  - capability: PandaX_2017_LogLikelihood
#    purpose:    LogLike

#  - capability: PICO_60_2017_LogLikelihood
#    purpose:    LogLike

#  - capability: PICO_60_2019_LogLikelihood
#    purpose:    LogLike

#  - capability: CRESST_III_LogLikelihood
#    purpose:    LogLike

#  - capability: CRESST_II_LogLikelihood
#    purpose:    LogLike

#  - capability: CDMSlite_LogLikelihood
#    purpose:    LogLike

#  - capability: DarkSide_50_LogLikelihood
#    purpose:    LogLike

Rules:

  - capability: RD_fraction
    function: RD_fraction_one

  - capability: DDCalc_Couplings
    function: DDCalc_Couplings_NR_WCs

  - capability: DD_nonrel_WCs
    function: DD_nonrel_WCs_flavscheme
  
  - capability: DMEFT_spectrum
    options:
      impose_EFT_validity: false

Logger:

  redirection:
    [Debug] : "debug.log"
    [Default] : "default.log"
    [DecayBit] : "DecayBit.log"
    [PrecisionBit] : "PrecisionBit.log"
    [SpecBit] : "SpecBit.log"
    [Dependency Resolver] : "dep_resolver.log"

KeyValues:

  dependency_resolution:
    prefer_model_specific_functions: true

  likelihood:
    model_invalid_for_lnlike_below: -5e100
    model_invalid_for_lnlike_below_alt: -1e100
    # use_lnlike_modifier: gaussian
    # lnlike_modifiers:
    #gaussian:
    #    mu: -7.805   # = -4.715 (known best-fit) - 3.09 (2-sigma threshold)
    #    sigma: 0.5

  default_output_path: "runs/DMEFT_3flavour_DAMA/"

  debug: false

