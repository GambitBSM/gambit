Binary files 4.1/.DS_Store and 4.1_patched/.DS_Store differ
diff -ruN 4.1/src/Makefile 4.1_patched/src/Makefile
--- 4.1/src/Makefile	2019-07-26 00:41:18.000000000 +0930
+++ 4.1_patched/src/Makefile	2020-04-29 01:11:09.000000000 +0930
@@ -37,7 +37,7 @@
 	  libsuperiso.a(spheno.o) libsuperiso.a(suspect.o) libsuperiso.a(2hdmc.o)\
 	  libsuperiso.a(fleshouches.o) libsuperiso.a(bsll.o) libsuperiso.a(bsll_extra.o)\
 	  libsuperiso.a(bkll.o) libsuperiso.a(bkstarll.o) libsuperiso.a(bkstargamma.o) libsuperiso.a(bsphill.o)\
-	  libsuperiso.a(chi2.o) libsuperiso.a(zwidths.o) libsuperiso.a(nmssmtools.o)\
+	  libsuperiso.a(chi2.o) libsuperiso.a(zwidths.o) libsuperiso.a(nmssmtools.o) libsuperiso.a(mixings.o) libsuperiso.a(bknunu.o)\
 	  $(RANL)
 
 libsuperiso.a(softsusy.o): softsusy.c include.h softsusy.h
@@ -70,6 +70,8 @@
 libsuperiso.a(bsphill.o): bsphill.c include.h
 libsuperiso.a(chi2.o): chi2.c include.h
 libsuperiso.a(zwidths.o): zwidths.c include.h
+libisospin.a(mixings.o): mixings.c include.h
+libsuperiso.a(bknunu.o): bknunu.c include.h
 
 softsusy.h:
 	@echo \#define SOFTSUSY \"$(SOFTSUSY)\" > softsusy.h;
diff -ruN 4.1/src/mixings.c 4.1_patched/src/mixings.c
--- 4.1/src/mixings.c	1970-01-01 09:30:00.000000000 +0930
+++ 4.1_patched/src/mixings.c	2020-04-18 02:42:48.000000000 +0930
@@ -0,0 +1,251 @@
+#include "include.h"
+
+/*--------------------------------------------------------------------*/
+/*---------------------------1511.05066-------------------------------*/
+/*--------------------------------------------------------------------*/
+
+double AWW(double x)
+{
+		if(fabs(1.-x)<1.e-5) return AWW(0.9999);
+		
+		return 1.+9./(1.-x)-6./(1.-x)/(1.-x)-6.*x*x*log(x)/pow(1.-x,3.);
+}
+
+/*--------------------------------------------------------------------*/
+
+double AWH(double xH, double xt, double xb, double lu, double ld)
+{
+		if((fabs(1.-xH)<1.e-5)&&(fabs(1.-xt)<1.e-5)) return AWH(0.9998,1.0002,xb,lu,ld);
+
+		if(fabs(1.-xH)<1.e-5) return AWH(0.9999,xt,xb,lu,ld);
+		if(fabs(1.-xt)<1.e-5) return AWH(xH,0.9999,xb,lu,ld);
+
+		if(fabs(1.-xH/xt)<1.e-5) return AWH(xt*0.9998,xt,xb,lu,ld);
+		
+		double xt2=xt*xt;
+		double xt3=xt*xt2;
+		double xt4=xt*xt3;
+		double xt5=xt*xt4;
+		
+		double xH2=xH*xH;
+		double xH3=xH*xH2;
+		double xH4=xH*xH3;
+		
+		return lu*lu*((4.-xt)/(xt-1.)/(xH-xt)+(xH-4.)*xH*log(xH)/(xH-1.)/(xH-xt)/(xH-xt)+(3.*xt2-(xt2-2.*xt+4.)*xH)*log(xt)/pow((xt-1.)*(xH-xt),2.))
+		+2.*xb/xt*(2.*ld*lu*(-1./(xH-xt)/(xt-1.)+xH*log(xH)/(xH-1.)/(xH-xt)/(xH-xt)-(-xH+xt2)*log(xt)/(xH-xt)/(xH-xt)/(xt-1.)/(xt-1.))
+		+lu*lu*(-1./36./(xH-1.)/(xH-1.)/pow((xH-xt)*(xt-1.),3.)*(-xH4*(-12.+65.*xt+2.*xt2+5.*xt3)
+		+2.*xH3*(-12.+47.*xt+85.*xt2-11.*xt3+11.*xt4)+xH2*(12.+91.*xt-574.*xt2+246.*xt3-130.*xt4-5.*xt5)
+		+2.*xH*xt*(-30.+95.*xt+49.*xt2-11.*xt3+17.*xt4)+xt2*(-24.+43.*xt-110.*xt2+31.*xt3))
+		-1./6./pow((xH-xt)*(xt-1.),4.)*(xt*((xH3-3.*xH2*xt)*(1.+9.*xt)-xt4*(12.-3.*xt+xt2)+3.*xH*xt*(4.-12.*xt+24.*xt2-7.*xt3+xt4))*log(xt))
+		-1./6./pow((xH-xt)*(xH-1.),3.)/(xH-xt)*(xt*xH*(-3.*xH3*(-3.+xt)+12.*xt*(1.+xt)-3.*xH*xt*(13.+xt)+xH2*(1.+10.*xt+xt2))*log(xH))));
+}
+
+/*--------------------------------------------------------------------*/
+
+double AHH(double xH, double xt, double xb, double lu)
+{
+		if((fabs(1.-xH)<1.e-5)&&(fabs(1.-xt)<1.e-5)) return AHH(0.9998,1.0002,xb,lu);
+
+		if(fabs(1.-xH)<1.e-5) return AHH(0.9999,xt,xb,lu);
+		if(fabs(1.-xt)<1.e-5) return AHH(xH,0.9999,xb,lu);
+
+		if(fabs(1.-xH/xt)<1.e-5) return AHH(xt*0.9998,xt,xb,lu);
+		
+		double xt2=xt*xt;
+		double xt3=xt*xt2;
+		
+		double xH2=xH*xH;
+		double xH3=xH*xH2;
+		
+		return pow(lu,4.)*((xt+xH)/(xt-xH)/(xt-xH)-2.*xt*xH/pow(xt-xH,3.)*log(xt/xH)
+		-xb*(1./9./pow(xH-xt,4.)*(5.*xH2-22.*xH*xt+5.*xt2)+1./3./pow(xH-xt,5.)*(xH3-3.*xH2*xt-3.*xH*xt2+xt3)*log(xt/xH)));	
+}
+
+/*--------------------------------------------------------------------*/
+
+double AHH_RR(double xH, double xt, double ld)
+{
+               if((fabs(1.-xH)<1.e-5)&&(fabs(1.-xt)<1.e-5)) return AHH_RR(0.9998,1.0002,ld);
+
+               if(fabs(1.-xH)<1.e-5) return AHH_RR(0.9999,xt,ld);
+               if(fabs(1.-xt)<1.e-5) return AHH_RR(xH,0.9999,ld);
+
+               if(fabs(1.-xH/xt)<1.e-5) return AHH_RR(xt*0.9998,xt,ld);
+               
+               double xt2=xt*xt;
+               double xt3=xt*xt2;
+               
+               double xH2=xH*xH; 
+               double xH3=xH*xH2;
+               
+               return (xt/xH)*pow(ld,4.)*(xt+xH)/(xt-xH)/(xt-xH)-2.*xt*xH/pow(xt-xH,3.)*log(xt/xH);
+}
+
+/*--------------------------------------------------------------------*/
+
+double AWH_ST(double xH, double xt, double lu, double ld)
+{
+		if((fabs(1.-xH)<1.e-5)&&(fabs(1.-xt)<1.e-5)) return AWH_ST(0.9998,1.0002,lu,ld);
+
+		if(fabs(1.-xH)<1.e-5) return AWH_ST(0.9999,xt,lu,ld);
+		if(fabs(1.-xt)<1.e-5) return AWH_ST(xH,0.9999,lu,ld);
+
+		if(fabs(1.-xH/xt)<1.e-5) return AWH_ST(xt*0.9998,xt,lu,ld);
+		
+		double xt2=xt*xt;
+		double xt3=xt*xt2;
+		double xt4=xt*xt3;
+		double xt5=xt*xt4;
+		
+		double xH2=xH*xH;
+		double xH3=xH*xH2;
+		double xH4=xH*xH3;
+		
+		return lu*lu*(1./9./pow((1.-xH)*(xH-xt)*(1.-xt),2.)/(xH-xt)/(1.-xt)*((xt2+xH4)*(-11.+7.*xt-2.*xt2)+xH*xt*(7.+53.*xt-55.*xt2+19.*xt3)
+		+xH2*(-2.-55.*xt+15.*xt2+17.*xt3-11.*xt4)+xH3*(19.+17.*xt-19.*xt2+7.*xt3))
+		+1./3./pow((1.-xH)*(xH-xt),3.)/(xH-xt)*(2.*xH*(xH2+(-3.+xH)*xH*xt+(3.+(xH-3.)*xH)*xt2)*log(xH))
+		-1./3./pow((xH-xt)*(1.-xt),4.)*(2.*(xH3-3.*xH2*xt+3.*xH*xt2-3.*xt4+3.*xt5-xt*xt5)*log(xt)))
+		+ld*lu*(1./2./(1.-xH)/pow((xH-xt)*(1.-xt),2.)*((xH2+xt)*(-3.+xt)+xH*(1.+6.*xt-3.*xt2))
+		+1./pow((xH-xt)*(1.-xt),3.)*((xH2-2.*xH*xt-(-2.+xt)*xt3)*log(xt))-1./pow((1.-xH)*(xH-xt),2.)/(xH-xt)*(xH*(xH-2.*xt+xH*xt)*log(xH)));	
+}
+
+/*--------------------------------------------------------------------*/
+
+double AHH_ST(double xH, double xt, double lu, double ld)
+{
+		if((fabs(1.-xH)<1.e-5)&&(fabs(1.-xt)<1.e-5)) return AHH_ST(0.9998,1.0002,lu,ld);
+
+		if(fabs(1.-xH)<1.e-5) return AHH_ST(0.9999,xt,lu,ld);
+		if(fabs(1.-xt)<1.e-5) return AHH_ST(xH,0.9999,lu,ld);
+
+		if(fabs(1.-xH/xt)<1.e-5) return AHH_ST(xt*0.9998,xt,lu,ld);
+		
+		double xt2=xt*xt;
+		double xt3=xt*xt2;
+		
+		double xH2=xH*xH;
+		double xH3=xH*xH2;
+		
+		return pow(ld*lu,2.)*(2./(xH-xt)/(xH-xt)+(xt+xH)/pow(xH-xt,3.)*log(xt/xH))
+		+pow(lu,4.)*(1./18./pow(xH-xt,4.)*(5.*xH2-22.*xH*xt+5.*xt2)+1./6./pow(xH-xt,5.)*(xH3-3.*xH2*xt-3.*xH*xt2+xt3)*log(xt/xH))
+		+ld*pow(lu,3.)*(2./(xH-xt)/(xH-xt)+(xH+xt)/pow(xH-xt,3.)*log(xt/xH));
+}
+
+/*--------------------------------------------------------------------*/
+
+double Delta_MB(struct parameters* param)
+/* computes the B_d mass difference Delta_MB*/
+{
+
+	double MH=param->mass_H;
+	double MW=param->mass_W;
+	
+	double fB2_Bd=pow(param->f_B,2.)*1.27; /* 1511.05066 */
+	double etaB=0.551;
+	double mt=running_mass(param->mtmt,param->mtmt,160.,param->mass_top_pole,param->mass_b,param);
+	double mb=running_mass(param->mass_b,param->mass_b,160.,param->mass_top_pole,param->mass_b,param);
+	
+	double xt=pow(mt/MW,2.);
+	
+	if(param->SM==1) 
+	{
+		double dmb=pow(param->Gfermi*MW,2.)*param->m_Bd/(24.*pow(pi,2.))*pow(cabs(conj(param->Vtd)*param->Vtb),2.)*fB2_Bd*etaB*xt*AWW(xt);
+	
+		return dmb/6.582119e-25*1.e-12; /* from GeV to ps-1 */
+	}
+
+	double xb=pow(mb/MW,2.);
+	double xH=pow(MH/MW,2.);
+
+	double ltt;
+	if(param->THDM_model>0) ltt=param->lambda_u[3][3];
+	else ltt=-1./param->tan_beta;
+
+	double lbb;
+	if(param->THDM_model>0) lbb=param->lambda_d[3][3];
+	else lbb=param->tan_beta;
+	
+	double CV=xt*(AWW(xt)+2.*xt*AWH(xH,xt,xb,ltt,lbb)+xt*AHH(xH,xt,xb,ltt));
+	double CST=4.*xb*xt*xt*(AWH_ST(xH,xt,ltt,lbb)+AHH_ST(xH,xt,ltt,lbb)); // CST=0;
+
+	double fB2_BdST_etaBST=pow(0.190,2.)*(-0.007)-pow(0.183,2.)*(5./8*1.654+5./2.*(-0.007));
+
+	double dmb=pow(param->Gfermi*MW,2.)*param->m_Bd/(24.*pow(pi,2.))*pow(cabs(conj(param->Vtd)*param->Vtb),2.)*(fB2_Bd*etaB*CV+fB2_BdST_etaBST*CST);
+	
+	return dmb/6.582119e-25*1.e-12; /* from GeV to ps-1 */
+}
+
+/*--------------------------------------------------------------------*/
+
+double Delta_MB_calculator(char name[])
+/* "container" function scanning the SLHA file "name" and calculating Delta_MB */
+{
+	struct parameters param;
+		
+	Init_param(&param);
+	
+	if(!Les_Houches_Reader(name,&param)) return 0.;
+
+	return Delta_MB(&param);
+}
+
+/*--------------------------------------------------------------------*/
+
+double Delta_MBs(struct parameters* param)
+/* computes the B_s mass difference Delta_MBs*/
+{
+
+	double MH=param->mass_H;
+	double MW=param->mass_W;
+	
+	double fBs2_Bs=pow(param->f_Bs,2.)*1.33; /* 1511.05066 */
+	double etaBs=0.551;
+	double mt=running_mass(param->mtmt,param->mtmt,160.,param->mass_top_pole,param->mass_b,param);
+	double mb=running_mass(param->mass_b,param->mass_b,160.,param->mass_top_pole,param->mass_b,param);
+       double ms=running_mass(param->mass_s,param->mass_s,160.,param->mass_top_pole,param->mass_b,param); 	
+
+	double xt=pow(mt/MW,2.);
+	
+	if(param->SM==1) 
+	{
+		double dmbs=pow(param->Gfermi*MW,2.)*param->m_Bs/(24.*pow(pi,2.))*pow(cabs(conj(param->Vts)*param->Vtb),2.)*fBs2_Bs*etaBs*xt*AWW(xt);
+	
+		return dmbs/6.582119e-25*1.e-12; /* from GeV to ps-1 */
+	}
+
+       double xs=pow(ms/MW,2.);
+	double xb=pow(mb/MW,2.);
+	double xH=pow(MH/MW,2.);
+
+	double ltt;
+	if(param->THDM_model>0) ltt=param->lambda_u[3][3];
+	else ltt=-1./param->tan_beta;
+
+	double lbb;
+	if(param->THDM_model>0) lbb=param->lambda_d[3][3];
+	else lbb=param->tan_beta;
+	
+	double CV_LL=xt*(AWW(xt)+2.*xt*AWH(xH,xt,xb,ltt,lbb)+xt*AHH(xH,xt,xb,ltt));
+       double CV_RR=xb*xs*AHH_RR(xH,xt,lbb);
+	double CST=4.*xb*xt*xt*(AWH_ST(xH,xt,ltt,lbb)+AHH_ST(xH,xt,ltt,lbb)); // CST=0;
+
+	double fBs2_BsST_etaBsST=pow(0.231,2.)*(-0.007)-pow(0.225,2.)*(5./8*1.654+5./2.*(-0.007));
+
+	double dmbs=pow(param->Gfermi*MW,2.)*param->m_Bs/(24.*pow(pi,2.))*pow(cabs(conj(param->Vts)*param->Vtb),2.)*(fBs2_Bs*etaBs*(CV_LL + CV_RR)+fBs2_BsST_etaBsST*CST);
+	
+	return dmbs/6.582119e-25*1.e-12; /* from GeV to ps-1 */
+}
+
+/*--------------------------------------------------------------------*/
+
+double Delta_MBs_calculator(char name[])
+/* "container" function scanning the SLHA file "name" and calculating Delta_MBs */
+{
+	struct parameters param;
+		
+	Init_param(&param);
+	
+	if(!Les_Houches_Reader(name,&param)) return 0.;
+
+	return Delta_MBs(&param);
+}
--- a/src/chi2.c	2020-10-14 19:40:57.635018399 +0200
+++ b/src/chi2.c	2020-10-14 19:41:08.083031147 +0200
@@ -1,6 +1,6 @@
 #include "include.h"
 
-#define NNUIS 161
+#define NNUIS 171
 
 //#define DEBUG
 
@@ -157,6 +157,17 @@ void set_nuisance(struct nuisance* nuisp
 	nuisparam->a1T_BK=(struct indnuis){-0.53,0.13,1,"a1T_BK"};
 	nuisparam->a2T_BK=(struct indnuis){-0.29,1.00,1,"a2T_BK"};
 	
+	nuisparam->L_HPQCD=(struct indnuis){1.304,0.010,1,"L_HPQCD"};
+	nuisparam->a00_HPQCD=(struct indnuis){0.2545,0.0090,1,"a00_HPQCD"};
+	nuisparam->a10_HPQCD=(struct indnuis){0.210,0.076,1,"a10_HPQCD"};
+	nuisparam->a20_HPQCD=(struct indnuis){0.02,0.17,1,"a20_HPQCD"};
+	nuisparam->a0p_HPQCD=(struct indnuis){0.2545,0.0090,1,"a0p_HPQCD"};
+	nuisparam->a1p_HPQCD=(struct indnuis){-0.71,0.14,1,"a1p_HPQCD"};
+	nuisparam->a2p_HPQCD=(struct indnuis){0.32,0.59,1,"a2p_HPQCD"};
+	nuisparam->a0T_HPQCD=(struct indnuis){0.255,0.018,1,"a0T_HPQCD"};
+	nuisparam->a1T_HPQCD=(struct indnuis){-0.66,0.23,1,"a1T_HPQCD"};
+	nuisparam->a2T_HPQCD=(struct indnuis){0.36,0.84,1,"a2T_HPQCD"};
+	
 	/* low */
 	nuisparam->BtoKlow_FV_err_noq2=(struct indnuis){0.,0.1,1,"BtoKlow_FV_err_noq2"};
 	nuisparam->BtoKlow_FA_err_noq2=(struct indnuis){0.,0.1,1,"BtoKlow_FA_err_noq2"};
@@ -394,6 +405,17 @@ void set_nuisance_deviation_to_zero(stru
 	nuisparam->a1T_BK.dev=0.;
 	nuisparam->a2T_BK.dev=0.;
 	
+	nuisparam->L_HPQCD.dev=0.;
+	nuisparam->a00_HPQCD.dev=0.;
+	nuisparam->a10_HPQCD.dev=0.;
+	nuisparam->a20_HPQCD.dev=0.;
+	nuisparam->a0p_HPQCD.dev=0.;
+	nuisparam->a1p_HPQCD.dev=0.;
+	nuisparam->a2p_HPQCD.dev=0.;
+	nuisparam->a0T_HPQCD.dev=0.;
+	nuisparam->a1T_HPQCD.dev=0.;
+	nuisparam->a2T_HPQCD.dev=0.;
+	
 	/* low */
 	nuisparam->BtoKlow_FV_err_noq2.dev=0.;
 	nuisparam->BtoKlow_FA_err_noq2.dev=0.;
@@ -634,6 +656,17 @@ void set_nuisance_value_from_param(struc
 	setparam(a1T_BK);
 	setparam(a2T_BK);
 	
+	setparam(L_HPQCD);
+	setparam(a00_HPQCD);
+	setparam(a10_HPQCD);
+	setparam(a20_HPQCD);
+	setparam(a0p_HPQCD);
+	setparam(a1p_HPQCD);
+	setparam(a2p_HPQCD);
+	setparam(a0T_HPQCD);
+	setparam(a1T_HPQCD);
+	setparam(a2T_HPQCD);
+	
 	/* low */
 	setparam(BtoKlow_FV_err_noq2);
 	setparam(BtoKlow_FA_err_noq2);
@@ -881,6 +914,17 @@ void write_nuisance(struct nuisance* nui
 	writeparam(a1T_BK);
 	writeparam(a2T_BK);
 	
+	writeparam(L_HPQCD);
+	writeparam(a00_HPQCD);
+	writeparam(a10_HPQCD);
+	writeparam(a20_HPQCD);
+	writeparam(a0p_HPQCD);
+	writeparam(a1p_HPQCD);
+	writeparam(a2p_HPQCD);
+	writeparam(a0T_HPQCD);
+	writeparam(a1T_HPQCD);
+	writeparam(a2T_HPQCD);
+	
 	/* low */
 	writeparam(BtoKlow_FV_err_noq2);
 	writeparam(BtoKlow_FA_err_noq2);
@@ -1112,6 +1156,16 @@ void read_nuisance(char name[], struct n
 		else readparam(a0T_BK)
 		else readparam(a1T_BK)
 		else readparam(a2T_BK)
+		else readparam(L_HPQCD)
+		else readparam(a00_HPQCD)
+		else readparam(a10_HPQCD)
+		else readparam(a20_HPQCD)
+		else readparam(a0p_HPQCD)
+		else readparam(a1p_HPQCD)
+		else readparam(a2p_HPQCD)
+		else readparam(a0T_HPQCD)
+		else readparam(a1T_HPQCD)
+		else readparam(a2T_HPQCD)
 		else readparam(BtoKlow_FV_err_noq2)
 		else readparam(BtoKlow_FA_err_noq2)
 		else readparam(BtoKlow_FS_err_noq2)
@@ -1323,10 +1377,10 @@ int read_nameobs(char name[], obsname* o
 int check_nameobs(obsname* obs)
 /* Checks if the observable name is valid or implemented into SuperIso. Returns 0 if invalid, 1 if valid */
 {
-	if(strcmp(obs->type,"BR")&&strcmp(obs->type,"BRuntag")&&strcmp(obs->type,"dGamma/dq2")&&strcmp(obs->type,"R-1")&&strcmp(obs->type,"AI")&&strcmp(obs->type,"ACP")&&strcmp(obs->type,"AFB")&&strcmp(obs->type,"FL")&&strcmp(obs->type,"FT")&&strcmp(obs->type,"ATRe")&&strcmp(obs->type,"AT1")&&strcmp(obs->type,"AT2")&&strcmp(obs->type,"AT3")&&strcmp(obs->type,"AT4")&&strcmp(obs->type,"AAT5")&&strcmp(obs->type,"HT1")&&strcmp(obs->type,"HT2")&&strcmp(obs->type,"HT3")&&strcmp(obs->type,"alpha")&&strcmp(obs->type,"AIm")&&strcmp(obs->type,"P1")&&strcmp(obs->type,"P2")&&strcmp(obs->type,"P3")&&strcmp(obs->type,"P6")&&strcmp(obs->type,"P4prime")&&strcmp(obs->type,"P5prime")&&strcmp(obs->type,"P6prime")&&strcmp(obs->type,"P8")&&strcmp(obs->type,"P8prime")&&strcmp(obs->type,"A7")&&strcmp(obs->type,"A8")&&strcmp(obs->type,"A9")&&strcmp(obs->type,"S3")&&strcmp(obs->type,"S4")&&strcmp(obs->type,"S5")&&strcmp(obs->type,"S7")&&strcmp(obs->type,"S8")&&
+	if(strcmp(obs->type,"BR")&&strcmp(obs->type,"BRuntag")&&strcmp(obs->type,"dGamma/dq2")&&strcmp(obs->type,"R")&&strcmp(obs->type,"R-1")&&strcmp(obs->type,"AI")&&strcmp(obs->type,"ACP")&&strcmp(obs->type,"AFB")&&strcmp(obs->type,"FL")&&strcmp(obs->type,"FT")&&strcmp(obs->type,"ATRe")&&strcmp(obs->type,"AT1")&&strcmp(obs->type,"AT2")&&strcmp(obs->type,"AT3")&&strcmp(obs->type,"AT4")&&strcmp(obs->type,"AAT5")&&strcmp(obs->type,"HT1")&&strcmp(obs->type,"HT2")&&strcmp(obs->type,"HT3")&&strcmp(obs->type,"alpha")&&strcmp(obs->type,"AIm")&&strcmp(obs->type,"P1")&&strcmp(obs->type,"P2")&&strcmp(obs->type,"P3")&&strcmp(obs->type,"P6")&&strcmp(obs->type,"P4prime")&&strcmp(obs->type,"P5prime")&&strcmp(obs->type,"P6prime")&&strcmp(obs->type,"P8")&&strcmp(obs->type,"P8prime")&&strcmp(obs->type,"A7")&&strcmp(obs->type,"A8")&&strcmp(obs->type,"A9")&&strcmp(obs->type,"S3")&&strcmp(obs->type,"S4")&&strcmp(obs->type,"S5")&&strcmp(obs->type,"S7")&&strcmp(obs->type,"S8")&&
 	strcmp(obs->type,"S9")&&strcmp(obs->type,"FH")&&strcmp(obs->type,"ATRe")&&strcmp(obs->type,"ATIm"))
 	{
-		printf("%s_%s: Unknown observable type: %s\n", obs->name, obs->type);
+		printf("%s: Unknown observable type: %s\n", obs->name, obs->type);
 		
 		return 0;
 	}
@@ -1347,9 +1401,10 @@ int check_nameobs(obsname* obs)
 	&&strcmp(obs->decay,"Dmunu")&&strcmp(obs->decay,"Denu")
 	&&strcmp(obs->decay,"Kmunu/pimunu")
 	&&strcmp(obs->decay,"BDmunu")&&strcmp(obs->decay,"BDenu")&&strcmp(obs->decay,"BDtaunu")
-	&&strcmp(obs->decay,"BDstarmunu")&&strcmp(obs->decay,"BDstarenu")&&strcmp(obs->decay,"BDstartaunu"))
+	&&strcmp(obs->decay,"BDstarmunu")&&strcmp(obs->decay,"BDstarenu")&&strcmp(obs->decay,"BDstartaunu")
+	&&strcmp(obs->decay,"BKnunu")&&strcmp(obs->decay,"B0K0nunu"))
 	{
-		printf("%s_%s: Unknown decay name: %s\n", obs->name, obs->decay);
+		printf("%s: Unknown decay name: %s\n", obs->name, obs->decay);
 		
 		return 0;
 	}
@@ -1362,8 +1417,9 @@ int check_nameobs(obsname* obs)
 	||!strcmp(obs->decay,"Bsphimumu")
 	||!strcmp(obs->decay,"Bsphiee")||!strcmp(obs->decay,"Bsphitautau")||!strcmp(obs->decay,"Bsphill")
 	||!strcmp(obs->decay,"BDmunu")||!strcmp(obs->decay,"BDenu")||!strcmp(obs->decay,"BDtaunu")
-	||!strcmp(obs->decay,"BDstarmunu")||!strcmp(obs->decay,"BDstarenu")||!strcmp(obs->decay,"BDstartaunu"))
-	&&(obs->low<=0.||obs->high<=0.||obs->low>obs->high))
+	||!strcmp(obs->decay,"BDstarmunu")||!strcmp(obs->decay,"BDstarenu")||!strcmp(obs->decay,"BDstartaunu")
+	||!strcmp(obs->decay,"BKnunu")||!strcmp(obs->decay,"B0K0nunu"))
+	&&(obs->low<0.||obs->high<=0.||obs->low>obs->high))
 	{
 		printf("%s: Wrong binning, please check: low=%g , high=%g\n", obs->name, obs->low, obs->high);
 		
@@ -1447,39 +1503,46 @@ double compute_nameobs(obsname* obs, int
 	
 	keprev=ke;
 	
-	static int WCmu,WCe,WCtau,WCbase2;
+	static int WCmu,WCe,WCtau,WCbase2,WCnu;
 	
-	if(reset) WCmu=WCe=WCtau=WCbase2=0;
+	if(reset) WCmu=WCe=WCtau=WCbase2=WCnu=0;
 
 	static double binlowBKmumu,binlowBKee,binlowBKtautau;
 	static double binlowBKstarmumu,binlowBKstaree,binlowBKstartautau;
 	static double binlowBsphimumu,binlowBsphiee,binlowBsphitautau;
+	static double binlowBKnunu;
 
 	static double binhighBKmumu,binhighBKee,binhighBKtautau;
 	static double binhighBKstarmumu,binhighBKstaree,binhighBKstartautau;
 	static double binhighBsphimumu,binhighBsphiee,binhighBsphitautau;
+	static double binhighBKnunu;
 	
-	if(reset) binlowBKmumu=binlowBKee=binlowBKtautau=binlowBKstarmumu=binlowBKstaree=binlowBKstartautau=binlowBsphimumu=binlowBsphiee=binlowBsphitautau=binhighBKmumu=binhighBKee=binhighBKtautau=binhighBKstarmumu=binhighBKstaree=binhighBKstartautau=binhighBsphimumu=binhighBsphiee=binhighBsphitautau=0.;
+	if(reset) binlowBKmumu=binlowBKee=binlowBKtautau=binlowBKstarmumu=binlowBKstaree=binlowBKstartautau=binlowBsphimumu=binlowBsphiee=binlowBsphitautau=binlowBKnunu=binhighBKmumu=binhighBKee=binhighBKtautau=binhighBKstarmumu=binhighBKstaree=binhighBKstartautau=binhighBsphimumu=binhighBsphiee=binhighBsphitautau=binhighBKnunu=0.;
 
 	static double obsBKstarmumu[Nobs_BKsll+1],obsBKmumu[Nobs_BKll+1],obsBsphimumu[Nobs_Bsphill+1];
 	static double obsBKstaree[Nobs_BKsll+1],obsBKee[Nobs_BKll+1],obsBsphiee[Nobs_Bsphill+1];
 	static double obsBKstartautau[Nobs_BKsll+1],obsBKtautau[Nobs_BKll+1],obsBsphitautau[Nobs_Bsphill+1];
+	static double obsBKnunu[Nobs_BKnunu+1];
 
 	static double binlowB0K0mumu,binlowB0K0ee,binlowB0K0tautau;
 	static double binlowB0Kstar0mumu,binlowB0Kstar0ee,binlowB0Kstar0tautau;
+	static double binlowB0K0nunu;
 
 	static double binhighB0K0mumu,binhighB0K0ee,binhighB0K0tautau;
 	static double binhighB0Kstar0mumu,binhighB0Kstar0ee,binhighB0Kstar0tautau;
+	static double binhighB0K0nunu;
 	
-	if(reset) binlowB0K0mumu=binlowB0K0ee=binlowB0K0tautau=binlowB0Kstar0mumu=binlowB0Kstar0ee=binlowB0Kstar0tautau=binhighB0K0mumu=binhighB0K0ee=binhighB0K0tautau=binhighB0Kstar0mumu=binhighB0Kstar0ee=binhighB0Kstar0tautau=0.;
+	if(reset) binlowB0K0mumu=binlowB0K0ee=binlowB0K0tautau=binlowB0Kstar0mumu=binlowB0Kstar0ee=binlowB0Kstar0tautau=binlowB0K0nunu=binhighB0K0mumu=binhighB0K0ee=binhighB0K0tautau=binhighB0Kstar0mumu=binhighB0Kstar0ee=binhighB0Kstar0tautau=binhighB0K0nunu=0.;
 	
 	static double obsB0Kstar0mumu[Nobs_BKsll+1],obsB0K0mumu[Nobs_BKll+1];
 	static double obsB0Kstar0ee[Nobs_BKsll+1],obsB0K0ee[Nobs_BKll+1];
 	static double obsB0Kstar0tautau[Nobs_BKsll+1],obsB0K0tautau[Nobs_BKll+1];
+	static double obsB0K0nunu[Nobs_BKnunu+1];
 
 	static double complex C0b[11],C0spec[11],C1b[11],C0w[11],C1w[11],C2w[11],C2b[11],Cpb[11],CQpb[3],CQ0b[3],CQ1b[3];
 	static double complex C0eb[11],C1eb[11],C0ew[11],C1ew[11],C2ew[11],C2eb[11],Cpeb[11],CQpeb[3],CQ0eb[3],CQ1eb[3];
 	static double complex C0taub[11],C1taub[11],C0tauw[11],C1tauw[11],C2tauw[11],C2taub[11],Cptaub[11],CQptaub[3],CQ0taub[3],CQ1taub[3];
+	static double complex CLR[2];
 
 	static double complex C0b_base2[11],C0spec_base2[11],C1b_base2[11],C1spec_base2[11];
 
@@ -1586,6 +1649,18 @@ double compute_nameobs(obsname* obs, int
 		double lambda_h=0.5;
 		return delta0(C0b_base2,C0spec_base2,C1b_base2,C1spec_base2,Cpb,param,mu_b,mu_spec,lambda_h);
 	}
+	
+	if(!strcmp(obs->decay,"BKnunu")||!strcmp(obs->decay,"B0K0nunu"))
+	{
+		if(WCnu==0)
+		{
+			CLR_calculator(CLR,param);
+			
+			if(param->deltaCLR!=NULL) for(ie=0;ie<2;ie++) CLR[ie]+=param->deltaCLR[ie];
+			
+			WCnu++;
+		}
+	}
 
 	if(!strcmp(obs->type,"BR")&&!strcmp(obs->decay,"BXsgamma")) return bsgamma(C0b,C1b,C2b,Cpb,mu_b,mu_W,param)*(1.+param->bsgamma_rand);
 
@@ -1910,6 +1985,17 @@ double compute_nameobs(obsname* obs, int
 		else if(!strcmp(obs->type,"ATIm")) return obsBKstartautau[32];
 	}
 
+	else if(!strcmp(obs->type,"R")&&!strcmp(obs->decay,"B0Kstar0ll"))
+	{
+		binlowB0Kstar0mumu=binlowB0Kstar0ee=obs->low;
+		binhighB0Kstar0mumu=binhighB0Kstar0ee=obs->high;
+		
+		obsB0Kstar0mumu[0]=BRBKstarll(2,0,obs->low,obs->high,obsB0Kstar0mumu,C0b,C1b,C2b,CQ0b,CQ1b,Cpb,CQpb,param,mu_b)/(obs->high-obs->low);
+		obsB0Kstar0ee[0]=BRBKstarll(1,0,obs->low,obs->high,obsB0Kstar0ee,C0eb,C1eb,C2eb,CQ0eb,CQ1eb,Cpeb,CQpeb,param,mu_b)/(obs->high-obs->low);
+	
+		return obsB0Kstar0mumu[0]/obsB0Kstar0ee[0];
+	}
+	
 	else if(!strcmp(obs->type,"R-1")&&!strcmp(obs->decay,"B0Kstar0ll"))
 	{
 		binlowB0Kstar0mumu=binlowB0Kstar0ee=obs->low;
@@ -1921,6 +2007,17 @@ double compute_nameobs(obsname* obs, int
 		return obsB0Kstar0mumu[0]/obsB0Kstar0ee[0]-1.;
 	}
 
+	else if(!strcmp(obs->type,"R")&&!strcmp(obs->decay,"BKstarll"))
+	{
+		binlowBKstarmumu=binlowBKstaree=obs->low;
+		binhighBKstarmumu=binhighBKstaree=obs->high;
+		
+		obsBKstarmumu[0]=BRBKstarll(2,1,obs->low,obs->high,obsBKstarmumu,C0b,C1b,C2b,CQ0b,CQ1b,Cpb,CQpb,param,mu_b)/(obs->high-obs->low);
+		obsBKstaree[0]=BRBKstarll(1,1,obs->low,obs->high,obsBKstaree,C0eb,C1eb,C2eb,CQ0eb,CQ1eb,Cpeb,CQpeb,param,mu_b)/(obs->high-obs->low);
+	
+		return obsBKstarmumu[0]/obsBKstaree[0];
+	}
+	
 	else if(!strcmp(obs->type,"R-1")&&!strcmp(obs->decay,"BKstarll"))
 	{
 		binlowBKstarmumu=binlowBKstaree=obs->low;
@@ -2024,6 +2121,17 @@ double compute_nameobs(obsname* obs, int
 		else if(!strcmp(obs->type,"FH")) return obsBKtautau[2];
 	}
 
+	else if(!strcmp(obs->type,"R")&&!strcmp(obs->decay,"B0K0ll"))
+	{
+		binlowB0K0mumu=binlowB0K0ee=obs->low;
+		binhighB0K0mumu=binhighB0K0ee=obs->high;
+		
+		obsB0K0mumu[0]=BRBKll(2,0,obs->low,obs->high,obsB0K0mumu,C0b,C1b,C2b,CQ0b,CQ1b,Cpb,CQpb,param,mu_b)/(obs->high-obs->low);
+		obsB0K0ee[0]=BRBKll(1,0,obs->low,obs->high,obsB0K0ee,C0eb,C1eb,C2eb,CQ0eb,CQ1eb,Cpeb,CQpeb,param,mu_b)/(obs->high-obs->low);
+		
+		return obsB0K0mumu[0]/obsB0K0ee[0];
+	}
+	
 	else if(!strcmp(obs->type,"R-1")&&!strcmp(obs->decay,"B0K0ll"))
 	{
 		binlowB0K0mumu=binlowB0K0ee=obs->low;
@@ -2035,6 +2143,17 @@ double compute_nameobs(obsname* obs, int
 		return obsB0K0mumu[0]/obsB0K0ee[0]-1.;
 	}
 
+	else if(!strcmp(obs->type,"R")&&!strcmp(obs->decay,"BKll"))
+	{
+		binlowBKmumu=binlowBKee=obs->low;
+		binhighBKmumu=binhighBKee=obs->high;
+		
+		obsBKmumu[0]=BRBKll(2,1,obs->low,obs->high,obsBKmumu,C0b,C1b,C2b,CQ0b,CQ1b,Cpb,CQpb,param,mu_b)/(obs->high-obs->low);
+		obsBKee[0]=BRBKll(1,1,obs->low,obs->high,obsBKee,C0eb,C1eb,C2eb,CQ0eb,CQ1eb,Cpeb,CQpeb,param,mu_b)/(obs->high-obs->low);
+
+		return obsBKmumu[0]/obsBKee[0];
+	}
+	
 	else if(!strcmp(obs->type,"R-1")&&!strcmp(obs->decay,"BKll"))
 	{
 		binlowBKmumu=binlowBKee=obs->low;
@@ -2119,8 +2238,36 @@ double compute_nameobs(obsname* obs, int
 		return obsBsphimumu[0]/obsBsphiee[0]-1.;
 	}
 
-	return -1.e30;
+	
+/* B -> K nu nu */
 
+	else if(!strcmp(obs->decay,"B0K0nunu"))
+	{
+		if(reset||(fabs(binlowB0K0nunu-obs->low)>1.e-5)||(fabs(binhighB0K0nunu-obs->high)>1.e-5))
+		{
+			obsB0K0nunu[0]=BRBKnunu(0,obs->low,obs->high,CLR[0],CLR[1],param,mu_b);
+		
+			binlowB0K0nunu=obs->low;
+			binhighB0K0nunu=obs->high;
+		}
+		
+		if(!strcmp(obs->type,"dGamma/dq2")) return obsB0K0nunu[0];
+	}
+
+	else if(!strcmp(obs->decay,"BKnunu"))
+	{
+		if(reset||(fabs(binlowBKnunu-obs->low)>1.e-5)||(fabs(binhighBKnunu-obs->high)>1.e-5))
+		{
+			obsBKnunu[0]=BRBKnunu(1,obs->low,obs->high,CLR[0],CLR[1],param,mu_b);
+		
+			binlowBKnunu=obs->low;
+			binhighBKnunu=obs->high;
+		}
+		
+		if(!strcmp(obs->type,"dGamma/dq2")) return obsBKnunu[0];
+	}
+
+	return -1.e30;
 }
 
 /*--------------------------------------------------------------------*/
@@ -2514,7 +2661,20 @@ void observables(int ke, obsname obs[],
 		setstdzero(a0T23_Bsphi);
 		setstdzero(a1T23_Bsphi);
 		setstdzero(a2T23_Bsphi);
+	
 	}
+	setparam(L_HPQCD,162);
+	setparam(a00_HPQCD,163);
+	setparam(a10_HPQCD,164);
+	setparam(a20_HPQCD,165);
+	
+	setparam(a0p_HPQCD,166);
+	setparam(a1p_HPQCD,167);
+	setparam(a2p_HPQCD,168);
+
+	setparam(a0T_HPQCD,169);
+	setparam(a1T_HPQCD,170);
+	setparam(a2T_HPQCD,171);
 
 #undef setparam
 #undef setstdzero
@@ -2541,9 +2701,9 @@ void observables(int ke, obsname obs[],
 	int test_highBKstar=(test_BKstar||mystrcmp(BtoKstarhigh_ALperp_err)||mystrcmp(BtoKstarhigh_ARperp_err)||mystrcmp(BtoKstarhigh_ALpar_err)||mystrcmp(BtoKstarhigh_ARpar_err)||mystrcmp(BtoKstarhigh_AL0_err)||mystrcmp(BtoKstarhigh_AR0_err)||mystrcmp(BtoKstarhigh_At_err)||mystrcmp(BtoKstarhigh_AS_err));
 
 	int test_BK=(mystrcmp(f_B)||mystrcmp(lambda_Bp));
-	int test_lowBK=test_BK||(mystrcmp(f_K)||mystrcmp(a1K)||mystrcmp(a2K)||mystrcmp(a00_BK)||mystrcmp(a10_BK)||mystrcmp(a20_BK)||mystrcmp(a30_BK)||mystrcmp(a0p_BK)||mystrcmp(a1p_BK)||mystrcmp(a2p_BK)||mystrcmp(a0T_BK)||mystrcmp(a1T_BK)||mystrcmp(a2T_BK)||mystrcmp(BtoKlow_FV_err_noq2)||mystrcmp(BtoKlow_FA_err_noq2)||mystrcmp(BtoKlow_FS_err_noq2)||mystrcmp(BtoKlow_FP_err_noq2)||mystrcmp(BtoKlow_FV_err_q2)||mystrcmp(BtoKlow_FA_err_q2)||mystrcmp(BtoKlow_FS_err_q2)||mystrcmp(BtoKlow_FP_err_q2));
-	int test_intermBK=test_BK||(mystrcmp(f_K)||mystrcmp(a1K)||mystrcmp(a2K)||mystrcmp(a00_BK)||mystrcmp(a10_BK)||mystrcmp(a20_BK)||mystrcmp(a30_BK)||mystrcmp(a0p_BK)||mystrcmp(a1p_BK)||mystrcmp(a2p_BK)||mystrcmp(a0T_BK)||mystrcmp(a1T_BK)||mystrcmp(a2T_BK)||mystrcmp(BtoKlow_FV_err_noq2)||mystrcmp(BtoKlow_FA_err_noq2)||mystrcmp(BtoKlow_FS_err_noq2)||mystrcmp(BtoKlow_FP_err_noq2)||mystrcmp(BtoKlow_FV_err_q2)||mystrcmp(BtoKlow_FA_err_q2)||mystrcmp(BtoKlow_FS_err_q2)||mystrcmp(BtoKlow_FP_err_q2)||mystrcmp(BtoKhigh_FV_err)||mystrcmp(BtoKhigh_FA_err)||mystrcmp(BtoKhigh_FS_err)||mystrcmp(BtoKhigh_FP_err));
-	int test_highBK=test_BK||(mystrcmp(f_K)||mystrcmp(a1K)||mystrcmp(a2K)||mystrcmp(a00_BK)||mystrcmp(a10_BK)||mystrcmp(a20_BK)||mystrcmp(a30_BK)||mystrcmp(a0p_BK)||mystrcmp(a1p_BK)||mystrcmp(a2p_BK)||mystrcmp(a0T_BK)||mystrcmp(a1T_BK)||mystrcmp(a2T_BK)||mystrcmp(BtoKhigh_FV_err)||mystrcmp(BtoKhigh_FA_err)||mystrcmp(BtoKhigh_FS_err)||mystrcmp(BtoKhigh_FP_err));
+	int test_lowBK=test_BK||(mystrcmp(f_K)||mystrcmp(a1K)||mystrcmp(a2K)||mystrcmp(a00_BK)||mystrcmp(a10_BK)||mystrcmp(a20_BK)||mystrcmp(a30_BK)||mystrcmp(a0p_BK)||mystrcmp(a1p_BK)||mystrcmp(a2p_BK)||mystrcmp(a0T_BK)||mystrcmp(a1T_BK)||mystrcmp(a2T_BK)||mystrcmp(L_HPQCD)||mystrcmp(a00_HPQCD)||mystrcmp(a10_HPQCD)||mystrcmp(a20_HPQCD)||mystrcmp(a0p_HPQCD)||mystrcmp(a1p_HPQCD)||mystrcmp(a2p_HPQCD)||mystrcmp(a0T_HPQCD)||mystrcmp(a1T_HPQCD)||mystrcmp(a2T_HPQCD)||mystrcmp(BtoKlow_FV_err_noq2)||mystrcmp(BtoKlow_FA_err_noq2)||mystrcmp(BtoKlow_FS_err_noq2)||mystrcmp(BtoKlow_FP_err_noq2)||mystrcmp(BtoKlow_FV_err_q2)||mystrcmp(BtoKlow_FA_err_q2)||mystrcmp(BtoKlow_FS_err_q2)||mystrcmp(BtoKlow_FP_err_q2));
+	int test_intermBK=test_BK||(mystrcmp(f_K)||mystrcmp(a1K)||mystrcmp(a2K)||mystrcmp(a00_BK)||mystrcmp(a10_BK)||mystrcmp(a20_BK)||mystrcmp(a30_BK)||mystrcmp(a0p_BK)||mystrcmp(a1p_BK)||mystrcmp(a2p_BK)||mystrcmp(a0T_BK)||mystrcmp(a1T_BK)||mystrcmp(a2T_BK)||mystrcmp(L_HPQCD)||mystrcmp(a00_HPQCD)||mystrcmp(a10_HPQCD)||mystrcmp(a20_HPQCD)||mystrcmp(a0p_HPQCD)||mystrcmp(a1p_HPQCD)||mystrcmp(a2p_HPQCD)||mystrcmp(a0T_HPQCD)||mystrcmp(a1T_HPQCD)||mystrcmp(a2T_HPQCD)||mystrcmp(BtoKlow_FV_err_noq2)||mystrcmp(BtoKlow_FA_err_noq2)||mystrcmp(BtoKlow_FS_err_noq2)||mystrcmp(BtoKlow_FP_err_noq2)||mystrcmp(BtoKlow_FV_err_q2)||mystrcmp(BtoKlow_FA_err_q2)||mystrcmp(BtoKlow_FS_err_q2)||mystrcmp(BtoKlow_FP_err_q2)||mystrcmp(BtoKhigh_FV_err)||mystrcmp(BtoKhigh_FA_err)||mystrcmp(BtoKhigh_FS_err)||mystrcmp(BtoKhigh_FP_err));
+	int test_highBK=test_BK||(mystrcmp(f_K)||mystrcmp(a1K)||mystrcmp(a2K)||mystrcmp(a00_BK)||mystrcmp(a10_BK)||mystrcmp(a20_BK)||mystrcmp(a30_BK)||mystrcmp(a0p_BK)||mystrcmp(a1p_BK)||mystrcmp(a2p_BK)||mystrcmp(a0T_BK)||mystrcmp(a1T_BK)||mystrcmp(a2T_BK)||mystrcmp(L_HPQCD)||mystrcmp(a00_HPQCD)||mystrcmp(a10_HPQCD)||mystrcmp(a20_HPQCD)||mystrcmp(a0p_HPQCD)||mystrcmp(a1p_HPQCD)||mystrcmp(a2p_HPQCD)||mystrcmp(a0T_HPQCD)||mystrcmp(a1T_HPQCD)||mystrcmp(a2T_HPQCD)||mystrcmp(BtoKhigh_FV_err)||mystrcmp(BtoKhigh_FA_err)||mystrcmp(BtoKhigh_FS_err)||mystrcmp(BtoKhigh_FP_err));
 
 	int test_Bsphi=(mystrcmp(life_Bs)||mystrcmp(f_Bs)||mystrcmp(lambda_Bsp)||mystrcmp(f_phi_par)||mystrcmp(f_phi_perp)||mystrcmp(a1phi_perp)||mystrcmp(a1phi_par)||mystrcmp(a2phi_perp)||mystrcmp(a2phi_par)||mystrcmp(a0A0_Bsphi)||mystrcmp(a1A0_Bsphi)||mystrcmp(a2A0_Bsphi)||mystrcmp(a0A1_Bsphi)||mystrcmp(a1A1_Bsphi)||mystrcmp(a2A1_Bsphi)||mystrcmp(a0A12_Bsphi)||mystrcmp(a1A12_Bsphi)||mystrcmp(a2A12_Bsphi)||mystrcmp(a0V_Bsphi)||mystrcmp(a1V_Bsphi)||mystrcmp(a2V_Bsphi)||mystrcmp(a0T1_Bsphi)||mystrcmp(a1T1_Bsphi)||mystrcmp(a2T1_Bsphi)||mystrcmp(a0T2_Bsphi)||mystrcmp(a1T2_Bsphi)||mystrcmp(a2T2_Bsphi)||mystrcmp(a0T23_Bsphi)||mystrcmp(a1T23_Bsphi)||mystrcmp(a2T23_Bsphi));
 	int test_lowBsphi=(test_Bsphi||mystrcmp(Bstophilow_ALperp_err_noq2)||mystrcmp(Bstophilow_ARperp_err_noq2)||mystrcmp(Bstophilow_ALpar_err_noq2)||mystrcmp(Bstophilow_ARpar_err_noq2)||mystrcmp(Bstophilow_AL0_err_noq2)||mystrcmp(Bstophilow_AR0_err_noq2)||mystrcmp(Bstophilow_At_err_noq2)||mystrcmp(Bstophilow_AS_err_noq2)||mystrcmp(Bstophilow_ALperp_err_q2)||mystrcmp(Bstophilow_ARperp_err_q2)||mystrcmp(Bstophilow_ALpar_err_q2)||mystrcmp(Bstophilow_ARpar_err_q2)||mystrcmp(Bstophilow_AL0_err_q2)||mystrcmp(Bstophilow_AR0_err_q2)||mystrcmp(Bstophilow_At_err_q2)||mystrcmp(Bstophilow_AS_err_q2));
@@ -2815,9 +2975,6 @@ void get_th_covariance_nuisance(double *
 
 	for(ie=0;ie<*nbobs;ie++) values_mod[0][ie]=values_ref[ie];		
 
-#if defined(_OPENMP)	
-#pragma omp parallel for private(ie)
-#endif
 	for(ke=1;ke<=n;ke++)
 	{			
 		double values[*nbobs];
--- a/src/wilson.c	2023-09-21 17:42:02.075695421 +0200
+++ b/src/wilson.c	2023-09-21 17:42:21.388121743 +0200
@@ -883,6 +883,8 @@ double T(double x)
 double F7_1(double x)
 {
 	if(fabs(1.-x)<1.e-5) return F7_1(0.9999);
+	// Modified by GAMBIT, for values of x close to 1 interpolate surrounding values
+	if(fabs(1.-x)<1e-2) return F7_1(1.01)*(50.*x-49.5) + F7_1(0.99)*(50.5-50*x);
 
 	return x*(7.-5.*x-8.*x*x)/24./pow(x-1.,3.)+x*x*(3.*x-2.)/4./pow(x-1.,4.)*log(x);
 }
@@ -892,6 +894,8 @@ double F7_1(double x)
 double F7_2(double x)
 {
 	if(fabs(1.-x)<1.e-5) return F7_2(0.9999);
+	// Modified by GAMBIT, for values of x close to 1 interpolate surrounding values
+	if(fabs(1.-x)<1e-2) return F7_2(1.01)*(50.*x-49.5) + F7_2(0.99)*(50.5-50*x);
 
 	return x*(3.-5.*x)/12./pow(x-1.,2.)+x*(3.*x-2.)/6./pow(x-1.,3.)*log(x);
 }
@@ -901,6 +905,8 @@ double F7_2(double x)
 double F8_1(double x)
 {
 	if(fabs(1.-x)<1.e-5) return F8_1(0.9999);
+	// Modified by GAMBIT, for values of x close to 1 interpolate surrounding values
+	if(fabs(1.-x)<1e-2) return F8_1(1.01)*(50.*x-49.5) + F8_1(0.99)*(50.5-50*x);
 
 	return x*(2.+5.*x-x*x)/8./pow(x-1.,3.)-3.*x*x/4./pow(x-1.,4.)*log(x);
 }
@@ -910,6 +916,8 @@ double F8_1(double x)
 double F8_2(double x)
 {
 	if(fabs(1.-x)<1.e-5) return F8_2(0.9999);
+	// Modified by GAMBIT, for values of x close to 1 interpolate surrounding values
+	if(fabs(1.-x)<1e-2) return F8_2(1.01)*(50.*x-49.5) + F8_2(0.99)*(50.5-50*x);
 
 	return x*(3.-x)/4./pow(x-1.,2.)-x/2./pow(x-1.,3.)*log(x);
 }
@@ -930,6 +938,8 @@ double B(double m1, double m2, double Q)
 double G7H(double x, double lu, double ld)
 {
 	if(fabs(1.-x)<1.e-5) return G7H(0.9999,lu,ld);
+	// Modified by GAMBIT, for values of x close to 1 interpolate surrounding values
+	if(fabs(1.-x)<1e-2) return G7H(1.01,lu,ld)*(50.*x-49.5) + G7H(0.99,lu,ld)*(50.5-50*x);
 
 	return lu*(ld*4.*x*(4.*(-3.+7.*x-2.*x*x)*Li2(1.-1./x)+(8.-14.*x-3.*x*x)*log(x)*log(x)/(x-1.)
 	+2.*(-3.-x+12.*x*x-2.*x*x*x)*log(x)/(x-1.)+3.*(7.-13.*x+2.*x*x))/9./pow((x-1.),3.)
@@ -942,6 +952,8 @@ double G7H(double x, double lu, double l
 double Delta7H(double x, double lu, double ld)
 {
 	if(fabs(1.-x)<1.e-5) return Delta7H(0.9999,lu,ld);
+	// Modified by GAMBIT, for values of x close to 1 interpolate surrounding values
+	if(fabs(1.-x)<1e-2) return Delta7H(1.01,lu,ld)*(50.*x-49.5) + Delta7H(0.99,lu,ld)*(50.5-50*x);
 
 	return 2.*x/9./pow((x-1.),4.)*lu*
 	(ld*((x-1.)*(21.-47.*x+8.*x*x)+2.*(-8.+14.*x+3.*x*x)*log(x))
@@ -953,6 +965,8 @@ double Delta7H(double x, double lu, doub
 double G8H(double x, double lu, double ld)
 {
 	if(fabs(1.-x)<1.e-5) return G8H(0.9999,lu,ld);
+	// Modified by GAMBIT, for values of x close to 1 interpolate surrounding values
+	if(fabs(1.-x)<1e-2) return G8H(1.01,lu,ld)*(50.*x-49.5) + G8H(0.99,lu,ld)*(50.5-50*x);
 
 	return lu*(ld*x*(0.5*(-36.+25.*x-17.*x*x)*Li2(1.-1./x)+(19.+17.*x)*log(x)*log(x)/(x-1.)
 	+0.25*(-3.-187.*x+12.*x*x-14.*x*x*x)*log(x)/(x-1.)+3.*(143.-44.*x+29.*x*x)/8.)/3./pow((x-1.),3.)
@@ -965,6 +979,8 @@ double G8H(double x, double lu, double l
 double Delta8H(double x, double lu, double ld)
 {
 	if(fabs(1.-x)<1.e-5) return Delta8H(0.9999,lu,ld);
+	// Modified by GAMBIT, for values of x close to 1 interpolate surrounding values
+	if(fabs(1.-x)<1e-2) return Delta8H(1.01,lu,ld)*(50.*x-49.5) + Delta8H(0.99,lu,ld)*(50.5-50*x);
 
 	return (x/6./pow((x-1.),4.))*lu*(ld*((x-1.)*(81.-16.*x+7.*x*x)-2.*(19.+17.*x)*log(x))
 	+lu*((-38.-261.*x+18.*x*x-7.*x*x*x)/6.+x*(31.+17.*x)*log(x)/(x-1.)));	
@@ -975,6 +991,8 @@ double Delta8H(double x, double lu, doub
 double EH(double x, double lu)
 {
 	if(fabs(1.-x)<1.e-5) return EH(0.9999,lu);
+	// Modified by GAMBIT, for values of x close to 1 interpolate surrounding values
+	if(fabs(1.-x)<1e-2) return EH(1.01,lu)*(50.*x-49.5) + EH(0.99,lu)*(50.5-50*x);
 
 	return lu*lu*x*((x-1.)*(16.-29.*x+7.*x*x)+6.*(3.*x-2.)*log(x))/36./pow((x-1.),4.);
 }
@@ -984,6 +1002,8 @@ double EH(double x, double lu)
 double G4H(double x, double lu)
 {
 	if(fabs(1.-x)<1.e-5) return G4H(0.9999,lu);
+	// Modified by GAMBIT, for values of x close to 1 interpolate surrounding values
+	if(fabs(1.-x)<1e-2) return G4H(1.01,lu)*(50.*x-49.5) + G4H(0.99,lu)*(50.5-50*x);
 
 	return lu*lu*((515.*x*x*x-906.*x*x+99.*x+182.)*x*Li2(1.-1./x)/54./pow(x-1.,4.)
 	+(1030.*x*x*x-2763.*x*x-15.*x+980.)*x*log(x)/108./pow(x-1.,5.)
@@ -995,6 +1015,8 @@ double G4H(double x, double lu)
 double Delta4H(double x, double lu)
 {
 	if(fabs(1.-x)<1.e-5) return Delta4H(0.9999,lu);
+	// Modified by GAMBIT, for values of x close to 1 interpolate surrounding values
+	if(fabs(1.-x)<1e-2) return Delta4H(1.01,lu)*(50.*x-49.5) + Delta4H(0.99,lu)*(50.5-50*x);
 
 	return -lu*lu*((-375.*x*x-95.*x+182.)*x*log(x)/54./pow(x-1.,5.)
 	+(133.*x*x*x-108.*x*x+4023.*x-2320.)*x/324./pow(x-1.,4.));
@@ -1005,6 +1027,8 @@ double Delta4H(double x, double lu)
 double G3H(double x, double lu)
 {
 	if(fabs(1.-x)<1.e-5) return G3H(0.9999,lu);
+	// Modified by GAMBIT, for values of x close to 1 interpolate surrounding values
+	if(fabs(1.-x)<1e-2) return G3H(1.01,lu)*(50.*x-49.5) + G3H(0.99,lu)*(50.5-50*x);
 
 	return lu*lu*((10.*x*x*x+30.*x-20.)*x*Li2(1.-1./x)/27./pow(x-1.,4.)
 	+(30.*x*x-66.*x-56.)*x*log(x)/81./pow(x-1.,4.)
@@ -1016,6 +1040,8 @@ double G3H(double x, double lu)
 double Delta3H(double x, double lu)
 {
 	if(fabs(1.-x)<1.e-5) return Delta3H(0.9999,lu);
+	// Modified by GAMBIT, for values of x close to 1 interpolate surrounding values
+	if(fabs(1.-x)<1e-2) return Delta3H(1.01,lu)*(50.*x-49.5) + Delta3H(0.99,lu)*(50.5-50*x);
 
 	return -lu*lu*((-30.*x+20.)*x*log(x)/27./pow(x-1.,4.)
 	+(-35.*x*x+145.*x-80.)*x/81./pow(x-1.,3.));
@@ -1035,6 +1061,8 @@ double C9llH0(double x, double y, double
 double D9H0(double x, double lu)
 {
 	if(fabs(1.-x)<1.e-5) return D9H0(0.9999,lu);
+	// Modified by GAMBIT, for values of x close to 1 interpolate surrounding values
+	if(fabs(1.-x)<1e-2) return D9H0(1.01,lu)*(50.*x-49.5) + D9H0(0.99,lu)*(50.5-50*x);
 
 	return lu*lu*((-3.*x*x*x+6.*x-4.)*x/18./pow(x-1.,4.)*log(x)+(47.*x*x-79.*x+38.)*x/108./pow(x-1.,3.));	
 }
@@ -1056,6 +1084,8 @@ double C9llH1(double x, double y, double
 double D9H1(double x, double lu, double L)
 {
 	if(fabs(x-1.)<1.e-5) return D9H1(0.9999,lu,L);
+	// Modified by GAMBIT, for values of x close to 1 interpolate surrounding values
+	if(fabs(1.-x)<1e-2) return D9H1(1.01,lu,L)*(50.*x-49.5) + D9H1(0.99,lu,L)*(50.5-50*x);
 	
 	return lu*lu*((380.*x*x*x-528.*x*x+72.*x+128.)*x/81.*pow(1.-x,4.)*Li2(1.-1./x)
 	+(596.*x*x*x-672.*x*x+64.*x+204.)*x*log(x)/81./pow(x-1.,5.)
@@ -1161,6 +1191,8 @@ double C7H2ldlumt(double r)
 double C7H2(double yt, double lu, double ld, double L)
 {
 	if(fabs(1.-yt)<1.e-5) return C7H2(0.9999,lu,ld,L);
+	// Modified by GAMBIT, for values of yt close to 1 interpolate surrounding values
+	if(fabs(1.-yt)<1e-2) return C7H2(1.01,lu,ld,L)*(50.*yt-49.5) + C7H2(0.99,lu,ld,L)*(50.5-50*yt);
 
 	return lu*lu*(C7H2lulumt(yt)+L*(-yt*(67930.*pow(yt,4.)-470095.*pow(yt,3.)+1358478.*yt*yt-700243.*yt+54970.)/2187./pow(yt-1.,5.)+yt*(10422.*pow(yt,4.)-84390.*pow(yt,3.)+322801.*yt*yt-146588.*yt+1435.)/729./pow(yt-1.,6.)*log(yt)+2.*yt*yt*(260.*pow(yt,3.)-1515.*yt*yt+3757.*yt-1446.)/27./pow(yt-1.,5.)*Li2(1.-1./yt))
 	+L*L*(yt*(-518.*pow(yt,4.)+3665.*pow(yt,3.)-17397.*yt*yt+3767.*yt+1843.)/162./pow(yt-1.,5.)+yt*yt*(-63.*pow(yt,3.)+532.*yt*yt+2089.*yt-1118.)/27./pow(yt-1.,6.)*log(yt))
@@ -1201,6 +1233,8 @@ double C8H2ldlumt(double r)
 double C8H2(double yt, double lu, double ld, double L)
 {
 	if(fabs(1.-yt)<1.e-5) return C8H2(0.9999,lu,ld,L);
+	// Modified by GAMBIT, for values of yt close to 1 interpolate surrounding values
+	if(fabs(1.-yt)<1e-2) return C8H2(1.01,lu,ld,L)*(50.*yt-49.5) + C8H2(0.99,lu,ld,L)*(50.5-50*yt);
 
 	return lu*lu*(C8H2lulumt(yt)+L*(yt*(51948.*pow(yt,4.)-233781.*pow(yt,3.)+48634.*yt*yt-698693.*yt+2452.)/1944./pow(yt-1.,6.)*log(yt)-yt*(522347.*pow(yt,4.)-2423255.*pow(yt,3.)+2706021.*yt*yt-5930609.*yt+148856.)/11664./pow(yt-1.,5.)+yt*yt*(481.*pow(yt,3.)-1950.*yt*yt+1523.*yt-2550.)/18./pow(yt-1.,5.)*Li2(1.-1./yt))
 	+L*L*(yt*(-259.*pow(yt,4.)+1117.*pow(yt,3.)+2925.*yt*yt+28411.*yt+2366.)/216./pow(yt-1.,5.)-yt*yt*(139.*yt*yt+2938.*yt+2683.)/36./pow(yt-1.,6.)*log(yt))
@@ -1427,8 +1461,9 @@ double F11SP(double xt, double xH)
 	double xt2=xt*xt;
 	double xt3=xt*xt2;
 
+	// Modified by GAMBIT, fixed typo on expression compared to 1511.05066
 	return 1./2./(xH-xt)*(xt*(xt2-3.*xH*xt+9.*xH-5.*xt-2.)/4./(xt-1.)/(xt-1.)+xH*(xH*xt-3.*xH+2.*xt)/2./(xH-1.)/(xH-xt)*log(xH)
-	+(xH*xH*(-2.*xt3+6.*xt2-9.*xt+2.)+3.*xH*xt2*(xt2-2.*xt+3.)-xt2*(2.*xt3-2.*xt2+3.*xt+1.))*log(xt)/2./pow(xt-1.,3.)/(xH-xt));
+	+(xH*xH*(-2.*xt3+6.*xt2-9.*xt+2.)+3.*xH*xt2*(xt2-2.*xt+3.)-xt2*(2.*xt3-3.*xt2+3.*xt+1.))*log(xt)/2./pow(xt-1.,3.)/(xH-xt));
 }
 
 /*--------------------------------------------------------------------*/
@@ -1475,6 +1510,9 @@ double CPc_2HDM(double xH, double xt, do
 		if(fabs(1.-xt)<1.e-5) return CPc_2HDM(xH,0.9999,lu,ld,ll,sw2);
 
 		if(fabs(1.-xH/xt)<1.e-5) return CPc_2HDM(xt*0.9998,xt,lu,ld,ll,sw2);
+		// Modified by GAMBIT, for values of xH close to xt interpolate surrounding values
+		if(fabs(1.-xH/xt)<1.e-3) return CPc_2HDM(xt*1.01,xt,lu,ld,ll,sw2)*(50.*xH/xt-49.5) + CPc_2HDM(xt*0.99,xt,lu,ld,ll,sw2)*(50.5-50*xH/xt);
+
 		
 		return -xt/8./(xH-xt)*(2.*ld*ll*(1./(xH-1.)*log(xH)-1./(xt-1.)*log(xt))
 		+lu*ll*(1./(xH-1.)+xH/(xH-xt)/(xt-1.)*log(xt)-xH*(2.*xH-xt-1.)/(xH-xt)/(xH-1.)/(xH-1.)*log(xH))
@@ -1482,7 +1520,8 @@ double CPc_2HDM(double xH, double xt, do
 		+xt/4./(xH-xt)/(xH-xt)*(-ld*lu*(-(xt+xH)/2.+xt*xH/(xH-xt)*log(xH/xt))
 		+lu*lu/6./(xH-xt)*((xH*xH-8.*xH*xt-17.*xt*xt)/6.+xt*xt*(3.*xH+xt)/(xH-xt)*log(xH/xt)))
 		+sw2*xt/6./(xH-xt)/(xH-xt)*(-ld*lu*((5.*xt-3.*xH)/2.+xH*(2.*xH-3.*xt)/(xH-xt)*log(xH/xt))
-		+lu*lu/6./(xH-xt)*((4.*xH*xH*xH-12.*xH*xH*xt+xH*xt*xt+3.*xt*xt*xt)/(xH-xt)*log(xH/xt)-(17.*xH*xH-64.*xH*xt+71.*xt*xt)/6.))
+		// Modified by GAMBIT, fixed typo on expression compared to 1511.01829
+		+lu*lu/6./(xH-xt)*((4.*xH*xH*xH-12.*xH*xH*xt+9.*xH*xt*xt+3.*xt*xt*xt)/(xH-xt)*log(xH/xt)-(17.*xH*xH-64.*xH*xt+71.*xt*xt)/6.))
 		+(1.-sw2)*lu*lu*xt*xt/4./(xH-xt)/(xH-xt)*(xH*log(xH/xt)+xt-xH);
 }
 
@@ -4512,3 +4551,38 @@ void CQ_calculator(int gen, double compl
 			
 	return;
 }
+
+/*-----------------------------------------------------------------------------*/
+
+double X0(double xt)
+{
+  if(xt < 1e-10) return 0.;
+  else if(fabs(xt-1) < 1e-10) return 11./16;
+  else return xt/8. * ((xt + 2.)/(xt - 1.) + (3.*xt - 6.)/pow(xt - 1.,2.) * log(xt));
+}
+
+double X1(double xt, double mu, double mass_W)
+{
+  if(xt < 1e-10) return 0.;
+  else if(fabs(xt-1) < 1e-10) return 3./4;
+  else return -(29.*xt - xt*xt - 4.*pow(xt,3.))/(3.*pow(1.-xt,2)) - (xt + 9.*xt*xt - pow(xt,3.) - pow(xt,4.))/(pow(1.-xt,3.)) * log(xt) + (8.*xt + 4.*xt*xt + xt*xt*xt - pow(xt,4.))/(2*pow(1.-xt,3)) * log(xt)*log(xt) - (4.*xt - pow(xt,3))/(pow(1.-xt,2)) * Li2(1.-xt) +  8.*xt*( (8. - 9.*xt + pow(xt,3.) +6.*log(xt))/(8.*pow(-1+xt,3)))*log(mu*mu/(mass_W*mass_W));
+}
+
+void CLR_calculator(double complex CLR[], struct parameters* param)
+{
+    double mu_W=param->mass_W;
+    double mu_b=param->mass_b_pole;
+
+    double mtmt = param->mtmt;
+    double xt = pow(mtmt/param->mass_W,2.);
+    double alphas_mut = alphas_running(mtmt,mtmt,param->mass_b_pole,param);
+
+    double XtSM = X0(xt) + alphas_mut/(4.*pi) * X1(xt,mtmt,param->mass_W);
+    double sw2=pow(sin(atan(param->gp/param->g2)),2.);
+
+    CLR[0] = -XtSM / sw2;   // CL = CLR[0]
+    CLR[1] = 0;             // CR = CLR[1]
+
+    return;
+}
+

--- a/src/include.h	2024-02-14 20:49:52.467221640 +0100
+++ b/src/include.h	2024-02-14 20:50:52.580464870 +0100
@@ -38,6 +38,7 @@
 #define Nobs_Bsphill 6
 #define Nobs_BDlnu 2
 #define Nobs_BDstarlnu 3
+#define Nobs_BKnunu 1
 
 #define NBOBSMAX 500
 
@@ -95,7 +96,7 @@ typedef struct parameters
 	double f_Kstar_par,f_Kstar_perp;
 	double f_phi_perp,f_phi_par,a1phi_perp,a2phi_perp,a1phi_par,a2phi_par;
 	double m_B,m_Bs,m_Bd,m_pi,m_Ds,m_K0,m_K,m_Kstar0,m_Kstar,m_D0,m_D,m_Dstar0,m_Dstar,m_phi;
-	double life_pi,life_K,life_B,life_Bs,life_Bd,life_D,life_Ds;
+	double life_pi,life_K,life_B,life_Bs,life_Bd,life_D,life_Ds,life_tau;
 	double a1par,a2par,a1perp,a2perp,a1K,a2K;
 	double zeta3A,zeta3V,wA10,deltatp,deltatm,deltatp_phi,deltatm_phi;
 	double lambda_Bp,lambda_Bsp,rho1,lambda2;
@@ -133,6 +134,10 @@ typedef struct parameters
 	double a00_BK,a10_BK,a20_BK,a30_BK;
 	double a0p_BK,a1p_BK,a2p_BK,DmBp_BK;
 	double a0T_BK,a1T_BK,a2T_BK,DmBT_BK;
+	double L_HPQCD;
+	double a00_HPQCD,a10_HPQCD,a20_HPQCD;
+	double a0p_HPQCD,a1p_HPQCD,a2p_HPQCD;
+	double a0T_HPQCD,a1T_HPQCD,a2T_HPQCD;
 	
 	/* B -> Kstar hadronic uncertainties */
 	double hadrerrBKstar;
@@ -178,7 +183,7 @@ typedef struct parameters
 	double Delta_BDstar,rho_Dstar2_BDstar,R1_1_BDstar,R2_1_BDstar,R3_1_BDstar,V1_1_BDstar,hA1_1_BDstar;
 			
 	/* NP contributions to Wilson coefficients */
-	double complex deltaC[31],deltaCp[31],deltaCQ[7],deltaCQp[7];
+	double complex deltaC[31],deltaCp[31],deltaCQ[7],deltaCQp[7],deltaCLR[2];
 				
 	/* Decay widths */
 	int widthcalc; /* 0=none, 1=hdecay, 2=feynhiggs */
@@ -333,6 +338,10 @@ typedef struct nuisance
 		indnuis a00_BK,a10_BK,a20_BK,a30_BK;
 		indnuis a0p_BK,a1p_BK,a2p_BK;
 		indnuis a0T_BK,a1T_BK,a2T_BK;
+		indnuis L_HPQCD;
+		indnuis a00_HPQCD,a10_HPQCD,a20_HPQCD;
+		indnuis a0p_HPQCD,a1p_HPQCD,a2p_HPQCD;
+		indnuis a0T_HPQCD,a1T_HPQCD,a2T_HPQCD;
 		
 		/* low */
 		indnuis BtoKlow_FV_err_noq2,BtoKlow_FA_err_noq2,BtoKlow_FS_err_noq2,BtoKlow_FP_err_noq2;
@@ -632,11 +641,14 @@ double epsilon_b(struct parameters* para
 double epsilon_bp(struct parameters* param);
 double epsilon_0p(struct parameters* param);
 double epsilon_1p(struct parameters* param);
+double X0(double xt);
+double X1(double xt, double mu, double mass_W);
 void CW_calculator(int gen, double complex C0w[], double complex C1w[], double complex C2w[], double mu_W, struct parameters* param); 
 void C_calculator_base1(double complex C0w[], double complex C1w[], double complex C2w[], double mu_W, double complex C0b[], double complex C1b[], double complex C2b[], double mu, struct parameters* param); 
 void C_calculator_base2(double complex C0w[], double complex C1w[], double mu_W, double complex C0b[], double complex C1b[], double mu, struct parameters* param); 
 void Cprime_calculator(int gen, double complex Cpb[], double complex CQpb[], double mu_W, double mu, struct parameters* param);
 void CQ_calculator(int gen, double complex CQ0b[], double complex CQ1b[], double mu_W, double mu, struct parameters* param);
+void CLR_calculator(double complex CLR[], struct parameters* param); 
 
 /* bsgamma.c */
 double phi77(double delta);
@@ -1054,4 +1066,11 @@ double Zwidth_neu1neu1_calculator(char n
 double Zwidth_invisible_calculator(char name[]);
 double Zwidth_b1b1_calculator(char name[]);
 
+/*bknunu.c */
+double dGamma_BKnunu_dq2_full(int charge, double q2, double complex CL, double complex CR, struct parameters* param, double mu_b);
+double dGamma_BKnunu_dq2_full_calculator(int charge, double q2, char name[]);
+double BRBKnunu_full(int charge, double smin, double smax, double complex CL, double complex CR, struct parameters* param, double mu_b);
+double dGamma_BKnunu_dq2(int charge, double q2, double complex CL, double complex CR, struct parameters* param, double mu_b);
+double BRBKnunu(int charge, double smin, double smax, double complex CL, double complex CR, struct parameters* param, double mu_b);
+
 #endif
--- a/src/leshouches.c	2024-02-15 15:41:11.723018989 +0100
+++ b/src/leshouches.c	2024-02-15 16:46:59.084097657 +0100
@@ -356,6 +356,7 @@ void Init_param(struct parameters* param
 	param->life_Bd=1.519e-12;
 	param->life_D=1.040e-12;
 	param->life_Ds=5.e-13;
+	param->life_tau=2.903e-13;
 	param->a1perp=0.04;
 	param->a2perp=0.10;
 	param->a1par=0.06;
@@ -464,6 +465,16 @@ void Init_param(struct parameters* param
 	param->a2T_BK=-0.29;
 	param->DmBp_BK=0.04578;
 	param->DmBT_BK=0.052;
+	param->L_HPQCD=1.304;
+	param->a00_HPQCD=0.2545;
+	param->a10_HPQCD=0.210;
+	param->a20_HPQCD=0.02;
+	param->a0p_HPQCD=0.2545;
+	param->a1p_HPQCD=-0.71;
+	param->a2p_HPQCD=0.32;
+	param->a0T_HPQCD=0.255;
+	param->a1T_HPQCD=-0.66;
+	param->a2T_HPQCD=0.36;
 	
 	/* hadronic uncertainties */
 	param->BtoKstarlow_ALperp_err_noq2=param->BtoKstarlow_ARperp_err_noq2=param->BtoKstarlow_ALpar_err_noq2=param->BtoKstarlow_ARpar_err_noq2=param->BtoKstarlow_AL0_err_noq2=param->BtoKstarlow_AR0_err_noq2=param->BtoKstarlow_At_err_noq2=param->BtoKstarlow_AS_err_noq2=param->BtoKstarlow_ALperp_err_q2=param->BtoKstarlow_ARperp_err_q2=param->BtoKstarlow_ALpar_err_q2=param->BtoKstarlow_ARpar_err_q2=param->BtoKstarlow_AL0_err_q2=param->BtoKstarlow_AR0_err_q2=param->BtoKstarlow_At_err_q2=param->BtoKstarlow_AS_err_q2=param->BtoKstarhigh_ALperp_err=param->BtoKstarhigh_ARperp_err=param->BtoKstarhigh_ALpar_err=param->BtoKstarhigh_ARpar_err=param->BtoKstarhigh_AL0_err=param->BtoKstarhigh_AR0_err=param->BtoKstarhigh_At_err=param->BtoKstarhigh_AS_err=0.;
--- a/chi2_input/nuisance_corr.in	2024-02-19 09:35:31.475063428 +0100
+++ b/chi2_input/nuisance_corr.in	2024-02-19 09:40:54.827128641 +0100
@@ -461,3 +461,48 @@ a2T2_Bsphi                    	a2T23_Bsp
 a0T23_Bsphi                   	a1T23_Bsphi                   	0.777787
 a0T23_Bsphi                   	a2T23_Bsphi                   	0.573289
 a1T23_Bsphi                   	a2T23_Bsphi                   	0.899178
+L_HPQCD                         a00_HPQCD                     	-0.19815
+L_HPQCD                         a10_HPQCD                     	0.02839
+L_HPQCD                         a20_HPQCD                     	0.03245
+L_HPQCD                         a0p_HPQCD                     	-0.19815
+L_HPQCD                         a1p_HPQCD                     	0.09126
+L_HPQCD                         a2p_HPQCD                     	0.00353
+L_HPQCD                         a0T_HPQCD                     	-0.11487
+L_HPQCD                         a1T_HPQCD                     	0.04788
+L_HPQCD                         a2T_HPQCD                     	0.00184
+a2T_HPQCD                       a00_HPQCD                     	0.0624
+a2T_HPQCD                       a10_HPQCD                     	0.05677
+a2T_HPQCD                       a20_HPQCD                     	0.04827
+a2T_HPQCD                       a0p_HPQCD                     	0.0624
+a2T_HPQCD                       a1p_HPQCD                     	0.05829
+a2T_HPQCD                       a2p_HPQCD                     	0.04442
+a2T_HPQCD                       a0T_HPQCD                     	0.32316
+a2T_HPQCD                       a1T_HPQCD                     	0.85349
+a1T_HPQCD                       a00_HPQCD                     	0.19136
+a1T_HPQCD                       a10_HPQCD                     	0.16899
+a1T_HPQCD                       a20_HPQCD                     	0.09938
+a1T_HPQCD                       a0p_HPQCD                     	0.19136
+a1T_HPQCD                       a1p_HPQCD                     	0.09633
+a1T_HPQCD                       a2p_HPQCD                     	0.02366
+a1T_HPQCD                       a0T_HPQCD                     	0.59841
+a0T_HPQCD                       a00_HPQCD                     	0.42939
+a0T_HPQCD                       a10_HPQCD                     	0.31091
+a0T_HPQCD                       a20_HPQCD                     	0.18297
+a0T_HPQCD                       a0p_HPQCD                     	0.42939
+a0T_HPQCD                       a1p_HPQCD                     	0.06813
+a0T_HPQCD                       a2p_HPQCD                     	-0.0247
+a2p_HPQCD                       a00_HPQCD                     	0.04776
+a2p_HPQCD                       a10_HPQCD                     	0.06186
+a2p_HPQCD                       a20_HPQCD                     	0.08655
+a2p_HPQCD                       a0p_HPQCD                     	0.04776
+a2p_HPQCD                       a1p_HPQCD                     	0.84649
+a1p_HPQCD                       a00_HPQCD                     	0.30543
+a1p_HPQCD                       a10_HPQCD                     	0.35356
+a1p_HPQCD                       a20_HPQCD                     	0.28531
+a1p_HPQCD                       a0p_HPQCD                     	0.30543
+a0p_HPQCD                       a00_HPQCD                     	1.
+a0p_HPQCD                       a10_HPQCD                     	0.80619
+a0p_HPQCD                       a20_HPQCD                     	0.56441
+a20_HPQCD                       a00_HPQCD                     	0.56441
+a20_HPQCD                       a10_HPQCD                     	0.91180
+a10_HPQCD                       a00_HPQCD                     	0.80619 
--- a/chi2_input/nuisance.in	2024-02-19 09:42:09.628996906 +0100
+++ b/chi2_input/nuisance.in	2024-02-19 09:44:10.076006166 +0100
@@ -181,3 +181,13 @@ a2T2_Bsphi
 a0T23_Bsphi                              	6.5233e-01		3.5747e-02		1
 a1T23_Bsphi                              	2.0962e+00		3.3008e-01		1
 a2T23_Bsphi                              	6.7357e+00		1.7953e+00		1
+L_HPQCD                                  	1.304                   0.010                   1
+a00_HPQCD                                	0.2545                  0.0090                  1
+a10_HPQCD                                	0.210                   0.076                   1
+a20_HPQCD                                	0.02                    0.17                    1
+a0p_HPQCD                                	0.2545                  0.0090                  1
+a1p_HPQCD                                	-0.71                   0.14                    1
+a2p_HPQCD                                	0.32                    0.59                    1
+a0T_HPQCD                                	0.255                   0.018                   1
+a1T_HPQCD                                	-0.66                   0.23                    1
+a2T_HPQCD                                	0.36                    0.84                    1 
